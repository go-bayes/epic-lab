<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.18">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Joseph A. Bulbulia">
<meta name="dcterms.date" content="2025-08-12">

<title>Self-Inflicted Injuries in Causal Inference – EPIC-lab: Evaluating Policy Implications with Causal-inference</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./images/favicon.ico" rel="icon">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-f98ea211b99fe8356d6469e598480a52.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark-5c1f7a6a2802c248a2ccc243aab7b5c3.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-f98ea211b99fe8356d6469e598480a52.css" rel="stylesheet" class="quarto-color-scheme-extra" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-da8cfa28642ddd9f9d9b25f2dac20544.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark-b79a49f0165146f7052aa612227e9af0.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="site_libs/bootstrap/bootstrap-da8cfa28642ddd9f9d9b25f2dac20544.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme-extra" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-XXXXXXXXXX"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-XXXXXXXXXX', { 'anonymize_ip': true});
</script>
<style>html{ scroll-behavior: smooth; }</style>
<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles.css">
<meta property="og:title" content="Self-Inflicted Injuries in Causal Inference – EPIC-lab: Evaluating Policy Implications with Causal-inference">
<meta property="og:description" content="Common Errors in Observational Studies">
<meta property="og:image" content="https://go-bayes.github.io/epic-lab/data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==">
<meta property="og:site_name" content="EPIC-lab">
<meta property="og:locale" content="en_US">
<meta name="twitter:title" content="Self-Inflicted Injuries in Causal Inference – EPIC-lab: Evaluating Policy Implications with Causal-inference">
<meta name="twitter:description" content="Common Errors in Observational Studies">
<meta name="twitter:image" content="https://go-bayes.github.io/epic-lab/data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==">
<meta name="twitter:creator" content="@prof_joe_">
<meta name="twitter:site" content="@prof_joe_">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-fixed quarto-light"><script id="quarto-html-before-body" type="application/javascript">
    const toggleBodyColorMode = (bsSheetEl) => {
      const mode = bsSheetEl.getAttribute("data-mode");
      const bodyEl = window.document.querySelector("body");
      if (mode === "dark") {
        bodyEl.classList.add("quarto-dark");
        bodyEl.classList.remove("quarto-light");
      } else {
        bodyEl.classList.add("quarto-light");
        bodyEl.classList.remove("quarto-dark");
      }
    }
    const toggleBodyColorPrimary = () => {
      const bsSheetEl = window.document.querySelector("link#quarto-bootstrap:not([rel=disabled-stylesheet])");
      if (bsSheetEl) {
        toggleBodyColorMode(bsSheetEl);
      }
    }
    const setColorSchemeToggle = (alternate) => {
      const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
      for (let i=0; i < toggles.length; i++) {
        const toggle = toggles[i];
        if (toggle) {
          if (alternate) {
            toggle.classList.add("alternate");
          } else {
            toggle.classList.remove("alternate");
          }
        }
      }
    };
    const toggleColorMode = (alternate) => {
      // Switch the stylesheets
      const primaryStylesheets = window.document.querySelectorAll('link.quarto-color-scheme:not(.quarto-color-alternate)');
      const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
      manageTransitions('#quarto-margin-sidebar .nav-link', false);
      if (alternate) {
        // note: dark is layered on light, we don't disable primary!
        enableStylesheet(alternateStylesheets);
        for (const sheetNode of alternateStylesheets) {
          if (sheetNode.id === "quarto-bootstrap") {
            toggleBodyColorMode(sheetNode);
          }
        }
      } else {
        disableStylesheet(alternateStylesheets);
        enableStylesheet(primaryStylesheets)
        toggleBodyColorPrimary();
      }
      manageTransitions('#quarto-margin-sidebar .nav-link', true);
      // Switch the toggles
      setColorSchemeToggle(alternate)
      // Hack to workaround the fact that safari doesn't
      // properly recolor the scrollbar when toggling (#1455)
      if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
        manageTransitions("body", false);
        window.scrollTo(0, 1);
        setTimeout(() => {
          window.scrollTo(0, 0);
          manageTransitions("body", true);
        }, 40);
      }
    }
    const disableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        stylesheet.rel = 'disabled-stylesheet';
      }
    }
    const enableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        if(stylesheet.rel !== 'stylesheet') { // for Chrome, which will still FOUC without this check
          stylesheet.rel = 'stylesheet';
        }
      }
    }
    const manageTransitions = (selector, allowTransitions) => {
      const els = window.document.querySelectorAll(selector);
      for (let i=0; i < els.length; i++) {
        const el = els[i];
        if (allowTransitions) {
          el.classList.remove('notransition');
        } else {
          el.classList.add('notransition');
        }
      }
    }
    const isFileUrl = () => {
      return window.location.protocol === 'file:';
    }
    const hasAlternateSentinel = () => {
      let styleSentinel = getColorSchemeSentinel();
      if (styleSentinel !== null) {
        return styleSentinel === "alternate";
      } else {
        return false;
      }
    }
    const setStyleSentinel = (alternate) => {
      const value = alternate ? "alternate" : "default";
      if (!isFileUrl()) {
        window.localStorage.setItem("quarto-color-scheme", value);
      } else {
        localAlternateSentinel = value;
      }
    }
    const getColorSchemeSentinel = () => {
      if (!isFileUrl()) {
        const storageValue = window.localStorage.getItem("quarto-color-scheme");
        return storageValue != null ? storageValue : localAlternateSentinel;
      } else {
        return localAlternateSentinel;
      }
    }
    const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
      const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
      const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
      let newTheme = '';
      if(authorPrefersDark) {
        newTheme = isAlternate ? baseTheme : alternateTheme;
      } else {
        newTheme = isAlternate ? alternateTheme : baseTheme;
      }
      const changeGiscusTheme = () => {
        // From: https://github.com/giscus/giscus/issues/336
        const sendMessage = (message) => {
          const iframe = document.querySelector('iframe.giscus-frame');
          if (!iframe) return;
          iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
        }
        sendMessage({
          setConfig: {
            theme: newTheme
          }
        });
      }
      const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
      if (isGiscussLoaded) {
        changeGiscusTheme();
      }
    };
    const authorPrefersDark = false;
    const darkModeDefault = authorPrefersDark;
      document.querySelector('link#quarto-text-highlighting-styles.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
      document.querySelector('link#quarto-bootstrap.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
    let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
    // Dark / light mode switch
    window.quartoToggleColorScheme = () => {
      // Read the current dark / light value
      let toAlternate = !hasAlternateSentinel();
      toggleColorMode(toAlternate);
      setStyleSentinel(toAlternate);
      toggleGiscusIfUsed(toAlternate, darkModeDefault);
      window.dispatchEvent(new Event('resize'));
    };
    // Switch to dark mode if need be
    if (hasAlternateSentinel()) {
      toggleColorMode(true);
    } else {
      toggleColorMode(false);
    }
  </script>

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="./index.html" class="navbar-brand navbar-brand-logo">
    </a>
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">EPIC-lab: Evaluating Policy Implications with Causal-inference</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-presentations" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">📊 PRESENTATIONS</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-presentations">    
        <li>
    <a class="dropdown-item" href="./presentations.html">
 <span class="dropdown-text">All Presentations</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li class="dropdown-header">2025</li>
        <li>
    <a class="dropdown-item" href="./presentations.html#apa-bier-2025">
 <span class="dropdown-text">APA-BIER: Causal Inference</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="./about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./team.html"> 
<span class="menu-text">Team</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./research.html"> 
<span class="menu-text">Research</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./resources.html"> 
<span class="menu-text">Resources</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="./discussion-points.html" aria-current="page"> 
<span class="menu-text">Discussion Points</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./news.html"> 
<span class="menu-text">News</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./reports.html"> 
<span class="menu-text">Reports</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/go-bayes"> <i class="bi bi-github" role="img" aria-label="GitHub">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://x.com/prof_joe_"> <i class="bi bi-twitter" role="img" aria-label="X (Twitter)">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://epiclab.bsky.social"> 
<span class="menu-text">Bluesky</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://orcid.org/0000-0002-5861-2056"> 
<span class="menu-text">ORCID</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#part-1-motivating-example" id="toc-part-1-motivating-example" class="nav-link active" data-scroll-target="#part-1-motivating-example"><strong>Part 1: Motivating Example</strong></a>
  <ul class="collapse">
  <li><a href="#s-observational-studies-indicated-30-all-cause-mortality-reduction-from-estrogen-therapies" id="toc-s-observational-studies-indicated-30-all-cause-mortality-reduction-from-estrogen-therapies" class="nav-link" data-scroll-target="#s-observational-studies-indicated-30-all-cause-mortality-reduction-from-estrogen-therapies">1990s observational studies indicated 30% all-cause mortality reduction from estrogen therapies?</a></li>
  <li><a href="#standard-medical-advice" id="toc-standard-medical-advice" class="nav-link" data-scroll-target="#standard-medical-advice">Standard Medical Advice</a></li>
  <li><a href="#womens-health-initiative-evaluate-estrogens-experimentally" id="toc-womens-health-initiative-evaluate-estrogens-experimentally" class="nav-link" data-scroll-target="#womens-health-initiative-evaluate-estrogens-experimentally">Women’s Health Initiative: Evaluate Estrogens Experimentally</a></li>
  <li><a href="#findings-clear-discrepancy" id="toc-findings-clear-discrepancy" class="nav-link" data-scroll-target="#findings-clear-discrepancy">Findings: <strong>Clear Discrepancy</strong></a></li>
  <li><a href="#medical-community-response-reject-all-observational-studies" id="toc-medical-community-response-reject-all-observational-studies" class="nav-link" data-scroll-target="#medical-community-response-reject-all-observational-studies">Medical community response: <strong>Reject</strong> all observational studies</a></li>
  <li><a href="#what-is-causality" id="toc-what-is-causality" class="nav-link" data-scroll-target="#what-is-causality">What is Causality?</a></li>
  <li><a href="#david-humes-two-definitions-in-enquiries-1751" id="toc-david-humes-two-definitions-in-enquiries-1751" class="nav-link" data-scroll-target="#david-humes-two-definitions-in-enquiries-1751">David Hume’s Two Definitions in <em>Enquiries</em> (1751)</a>
  <ul class="collapse">
  <li><a href="#definition-1" id="toc-definition-1" class="nav-link" data-scroll-target="#definition-1">Definition 1:</a></li>
  <li><a href="#definition-2" id="toc-definition-2" class="nav-link" data-scroll-target="#definition-2">Definition 2:</a></li>
  </ul></li>
  <li><a href="#our-lives-are-filled-with-what-if-questions" id="toc-our-lives-are-filled-with-what-if-questions" class="nav-link" data-scroll-target="#our-lives-are-filled-with-what-if-questions">Our lives are filled with “What If?” questions</a></li>
  <li><a href="#section" id="toc-section" class="nav-link" data-scroll-target="#section"></a></li>
  <li><a href="#the-fundamental-problem-of-causal-inference" id="toc-the-fundamental-problem-of-causal-inference" class="nav-link" data-scroll-target="#the-fundamental-problem-of-causal-inference"><strong>The Fundamental Problem of Causal Inference</strong></a></li>
  <li><a href="#however-we-only-observe-facts-not-counterfactuals" id="toc-however-we-only-observe-facts-not-counterfactuals" class="nav-link" data-scroll-target="#however-we-only-observe-facts-not-counterfactuals">However, we only observe <em>facts</em> not <em>counterfactuals</em></a></li>
  <li><a href="#average-treatment-effect-in-randomised-controlled-experiments-work-from-assumptions" id="toc-average-treatment-effect-in-randomised-controlled-experiments-work-from-assumptions" class="nav-link" data-scroll-target="#average-treatment-effect-in-randomised-controlled-experiments-work-from-assumptions">Average Treatment Effect in randomised controlled experiments work from assumptions</a></li>
  <li><a href="#under-identifying-assumptions-we-may-infer-causal-effects-from-associations" id="toc-under-identifying-assumptions-we-may-infer-causal-effects-from-associations" class="nav-link" data-scroll-target="#under-identifying-assumptions-we-may-infer-causal-effects-from-associations">Under identifying assumptions, we may infer causal effects from associations</a></li>
  </ul></li>
  <li><a href="#part-2-the-first-self-inflicted-error-the-what-error" id="toc-part-2-the-first-self-inflicted-error-the-what-error" class="nav-link" data-scroll-target="#part-2-the-first-self-inflicted-error-the-what-error"><strong>Part 2: The First Self-Inflicted Error: The <em>What</em> Error</strong></a>
  <ul class="collapse">
  <li><a href="#paradigmatic-concern-confounding-by-common-cause" id="toc-paradigmatic-concern-confounding-by-common-cause" class="nav-link" data-scroll-target="#paradigmatic-concern-confounding-by-common-cause">Paradigmatic Concern: Confounding by Common Cause</a></li>
  <li><a href="#where-assumptions-justify-we-may-condition-on-measured-confounders-to-obtain-balance." id="toc-where-assumptions-justify-we-may-condition-on-measured-confounders-to-obtain-balance." class="nav-link" data-scroll-target="#where-assumptions-justify-we-may-condition-on-measured-confounders-to-obtain-balance.">Where assumptions justify, we may condition on measured confounders to obtain balance.</a></li>
  </ul></li>
  <li><a href="#error-1-what-over-adjustment" id="toc-error-1-what-over-adjustment" class="nav-link" data-scroll-target="#error-1-what-over-adjustment">Error 1 – What (over-adjustment)</a>
  <ul class="collapse">
  <li><a href="#what-error-1-mediator-bias" id="toc-what-error-1-mediator-bias" class="nav-link" data-scroll-target="#what-error-1-mediator-bias">“What Error #1”: <strong>Mediator Bias</strong></a></li>
  <li><a href="#data-generating-process" id="toc-data-generating-process" class="nav-link" data-scroll-target="#data-generating-process">Data Generating Process</a></li>
  <li><a href="#model-comparison" id="toc-model-comparison" class="nav-link" data-scroll-target="#model-comparison">Model comparison</a></li>
  <li><a href="#which-model-looks-better" id="toc-which-model-looks-better" class="nav-link" data-scroll-target="#which-model-looks-better">Which model looks better?</a></li>
  <li><a href="#what-error-2-collider-bias" id="toc-what-error-2-collider-bias" class="nav-link" data-scroll-target="#what-error-2-collider-bias">“What Error #2”: Collider Bias</a></li>
  <li><a href="#data-generating-process-1" id="toc-data-generating-process-1" class="nav-link" data-scroll-target="#data-generating-process-1">Data Generating Process</a></li>
  <li><a href="#model-comparison-1" id="toc-model-comparison-1" class="nav-link" data-scroll-target="#model-comparison-1">Model Comparison</a></li>
  <li><a href="#which-model-looks-better-1" id="toc-which-model-looks-better-1" class="nav-link" data-scroll-target="#which-model-looks-better-1">Which model looks better?</a></li>
  <li><a href="#take-home" id="toc-take-home" class="nav-link" data-scroll-target="#take-home">Take-Home</a></li>
  <li><a href="#the-what-error-is-widespread-in-experimental-studies-in-the-social-sciences" id="toc-the-what-error-is-widespread-in-experimental-studies-in-the-social-sciences" class="nav-link" data-scroll-target="#the-what-error-is-widespread-in-experimental-studies-in-the-social-sciences">The What Error is widespread in <strong>experimental</strong> studies in the social sciences</a></li>
  <li><a href="#mediator-bias-control-strategy-longitudinal-hygiene" id="toc-mediator-bias-control-strategy-longitudinal-hygiene" class="nav-link" data-scroll-target="#mediator-bias-control-strategy-longitudinal-hygiene">Mediator Bias control strategy: <strong>Longitudinal Hygiene</strong></a></li>
  <li><a href="#how-to-tame-the-what-error-hide-your-future" id="toc-how-to-tame-the-what-error-hide-your-future" class="nav-link" data-scroll-target="#how-to-tame-the-what-error-hide-your-future">How to Tame The What Error? <strong>Hide your future</strong></a></li>
  <li><a href="#collider-bias-control-strategy-hide-your-future" id="toc-collider-bias-control-strategy-hide-your-future" class="nav-link" data-scroll-target="#collider-bias-control-strategy-hide-your-future">Collider bias control strategy: <strong>Hide your future</strong></a></li>
  <li><a href="#collider-bias-by-proxy-control-strategy-hide-your-future" id="toc-collider-bias-by-proxy-control-strategy-hide-your-future" class="nav-link" data-scroll-target="#collider-bias-by-proxy-control-strategy-hide-your-future">Collider bias by proxy control strategy: <strong>Hide your future</strong></a></li>
  <li><a href="#post-exposure-collider-bias-control-strategy-hide-your-future" id="toc-post-exposure-collider-bias-control-strategy-hide-your-future" class="nav-link" data-scroll-target="#post-exposure-collider-bias-control-strategy-hide-your-future">Post-exposure collider bias control strategy: <strong>Hide your future</strong></a></li>
  <li><a href="#finally-our-biggest-worry-unmeasured-common-causes" id="toc-finally-our-biggest-worry-unmeasured-common-causes" class="nav-link" data-scroll-target="#finally-our-biggest-worry-unmeasured-common-causes">Finally, our biggest worry: <strong>Unmeasured Common Causes</strong></a></li>
  <li><a href="#unmeasured-common-cause-strategy-hide-your-future" id="toc-unmeasured-common-cause-strategy-hide-your-future" class="nav-link" data-scroll-target="#unmeasured-common-cause-strategy-hide-your-future">Unmeasured common cause strategy: <strong>Hide your future</strong></a></li>
  <li><a href="#are-longitudinal-data-sensitivity-analysis-enough" id="toc-are-longitudinal-data-sensitivity-analysis-enough" class="nav-link" data-scroll-target="#are-longitudinal-data-sensitivity-analysis-enough">Are longitudinal data + sensitivity analysis enough?</a></li>
  <li><a href="#are-longitudinal-data-sensitivity-analysis-enough-1" id="toc-are-longitudinal-data-sensitivity-analysis-enough-1" class="nav-link" data-scroll-target="#are-longitudinal-data-sensitivity-analysis-enough-1">Are longitudinal data + sensitivity analysis enough?</a></li>
  </ul></li>
  <li><a href="#error-2-when-time-zero" id="toc-error-2-when-time-zero" class="nav-link" data-scroll-target="#error-2-when-time-zero">Error 2: When (time-zero)</a>
  <ul class="collapse">
  <li><a href="#longitudinal-data-are-not-enough" id="toc-longitudinal-data-are-not-enough" class="nav-link" data-scroll-target="#longitudinal-data-are-not-enough"><strong>Longitudinal data</strong> are <strong>not</strong> enough</a></li>
  <li><a href="#researchers-failed-to-emulate-an-experiment-in-their-data-target-trial" id="toc-researchers-failed-to-emulate-an-experiment-in-their-data-target-trial" class="nav-link" data-scroll-target="#researchers-failed-to-emulate-an-experiment-in-their-data-target-trial">Researchers failed to emulate an experiment in their data (Target Trial)</a></li>
  <li><a href="#visualising-the-when-error" id="toc-visualising-the-when-error" class="nav-link" data-scroll-target="#visualising-the-when-error">Visualising the When Error</a></li>
  <li><a href="#target-trial-check-list" id="toc-target-trial-check-list" class="nav-link" data-scroll-target="#target-trial-check-list">Target Trial Check List</a></li>
  </ul></li>
  <li><a href="#error-3-who-population-and-heterogeneity" id="toc-error-3-who-population-and-heterogeneity" class="nav-link" data-scroll-target="#error-3-who-population-and-heterogeneity">Error 3 – Who (population and heterogeneity)</a>
  <ul class="collapse">
  <li><a href="#illustration" id="toc-illustration" class="nav-link" data-scroll-target="#illustration">Illustration</a></li>
  </ul></li>
  <li><a href="#new-zealand-attitudes-and-values-study-nzavs-a-step-by-step-workflow-for-causal-inference" id="toc-new-zealand-attitudes-and-values-study-nzavs-a-step-by-step-workflow-for-causal-inference" class="nav-link" data-scroll-target="#new-zealand-attitudes-and-values-study-nzavs-a-step-by-step-workflow-for-causal-inference">New Zealand Attitudes and Values Study (NZAVS): A step-by-step workflow for causal inference</a>
  <ul class="collapse">
  <li><a href="#the-new-zealand-attitudes-and-values-study" id="toc-the-new-zealand-attitudes-and-values-study" class="nav-link" data-scroll-target="#the-new-zealand-attitudes-and-values-study">The New Zealand Attitudes and Values Study:</a></li>
  <li><a href="#causal-questions" id="toc-causal-questions" class="nav-link" data-scroll-target="#causal-questions">Causal Questions</a></li>
  <li><a href="#outcomes" id="toc-outcomes" class="nav-link" data-scroll-target="#outcomes">Outcomes</a></li>
  <li><a href="#three-wave-panel-design-control-for-baseline-exposure-and-outcome-among-confounder-set." id="toc-three-wave-panel-design-control-for-baseline-exposure-and-outcome-among-confounder-set." class="nav-link" data-scroll-target="#three-wave-panel-design-control-for-baseline-exposure-and-outcome-among-confounder-set.">Three-wave Panel Design: control for baseline exposure and outcome among confounder set.</a></li>
  <li><a href="#target-population-residents-of-new-zealand-in-2018-had-they-not-been-censored-through-2021." id="toc-target-population-residents-of-new-zealand-in-2018-had-they-not-been-censored-through-2021." class="nav-link" data-scroll-target="#target-population-residents-of-new-zealand-in-2018-had-they-not-been-censored-through-2021.">Target Population: Residents of New Zealand in 2018 had they not been censored through 2021.</a>
  <ul class="collapse">
  <li><a href="#census-weights-age-x-gender-x-ethnicity" id="toc-census-weights-age-x-gender-x-ethnicity" class="nav-link" data-scroll-target="#census-weights-age-x-gender-x-ethnicity">Census Weights (Age X Gender X Ethnicity)</a></li>
  <li><a href="#ipcw-stabilised-trimmed" id="toc-ipcw-stabilised-trimmed" class="nav-link" data-scroll-target="#ipcw-stabilised-trimmed">(IPCW Stabilised &amp; Trimmed)</a></li>
  </ul></li>
  <li><a href="#religious-service-intervention" id="toc-religious-service-intervention" class="nav-link" data-scroll-target="#religious-service-intervention">Religious Service Intervention</a></li>
  <li><a href="#histogram-showing-split" id="toc-histogram-showing-split" class="nav-link" data-scroll-target="#histogram-showing-split">Histogram Showing Split</a></li>
  <li><a href="#love-plot-of-propensity-scores" id="toc-love-plot-of-propensity-scores" class="nav-link" data-scroll-target="#love-plot-of-propensity-scores">Love Plot of Propensity Scores</a></li>
  <li><a href="#average-treatment-effect-results" id="toc-average-treatment-effect-results" class="nav-link" data-scroll-target="#average-treatment-effect-results">Average Treatment Effect Results:</a></li>
  <li><a href="#workflow" id="toc-workflow" class="nav-link" data-scroll-target="#workflow">Workflow</a></li>
  <li><a href="#transition-table-religious-attendance" id="toc-transition-table-religious-attendance" class="nav-link" data-scroll-target="#transition-table-religious-attendance">Transition table: Religious Attendance</a></li>
  <li><a href="#average-treatment-effect" id="toc-average-treatment-effect" class="nav-link" data-scroll-target="#average-treatment-effect">Average Treatment Effect</a></li>
  </ul></li>
  <li><a href="#graph-ate" id="toc-graph-ate" class="nav-link" data-scroll-target="#graph-ate">Graph ATE</a>
  <ul class="collapse">
  <li><a href="#how-much-better-if-we-treated-by-cate" id="toc-how-much-better-if-we-treated-by-cate" class="nav-link" data-scroll-target="#how-much-better-if-we-treated-by-cate">How Much Better if We Treated by CATE?</a></li>
  <li><a href="#who-should-we-treat-first-belonging" id="toc-who-should-we-treat-first-belonging" class="nav-link" data-scroll-target="#who-should-we-treat-first-belonging">Who Should We Treat First? Belonging</a></li>
  <li><a href="#who-should-we-treat-first-charitable-donations" id="toc-who-should-we-treat-first-charitable-donations" class="nav-link" data-scroll-target="#who-should-we-treat-first-charitable-donations">Who Should We Treat First? Charitable Donations</a></li>
  <li><a href="#closing" id="toc-closing" class="nav-link" data-scroll-target="#closing">Closing</a></li>
  <li><a href="#thanks" id="toc-thanks" class="nav-link" data-scroll-target="#thanks">Thanks</a></li>
  <li><a href="#section-1" id="toc-section-1" class="nav-link" data-scroll-target="#section-1"></a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">


<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Self-Inflicted Injuries in Causal Inference</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
<p class="subtitle lead">Common Errors in Observational Studies</p>
</div>


<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">Author</div>
  <div class="quarto-title-meta-heading">Affiliation</div>
  
    <div class="quarto-title-meta-contents">
    <p class="author">Joseph A. Bulbulia <a href="mailto:joseph.bulbulia@vuw.ac.nz" class="quarto-title-author-email"><i class="bi bi-envelope"></i></a> <a href="https://orcid.org/0000-0002-5861-2056" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a></p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            Victoria University of Wellington, New Zealand
          </p>
      </div>
  </div>

<div class="quarto-title-meta">

      
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">August 12, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="part-1-motivating-example" class="level1">
<h1><strong>Part 1: Motivating Example</strong></h1>
<section id="s-observational-studies-indicated-30-all-cause-mortality-reduction-from-estrogen-therapies" class="level2">
<h2 class="anchored" data-anchor-id="s-observational-studies-indicated-30-all-cause-mortality-reduction-from-estrogen-therapies">1990s observational studies indicated 30% all-cause mortality reduction from estrogen therapies?</h2>
<div class="callout callout-style-default callout-note callout-titled" title="In the 1980s and 1990s estrogen treatments appeared to **benefit** postmenopausal women">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>In the 1980s and 1990s estrogen treatments appeared to <strong>benefit</strong> postmenopausal women
</div>
</div>
<div class="callout-body-container callout-body">
<p>Hazard ratio for all-cause mortality: <strong>0.68</strong> current users vs.&nbsp;never users <span class="citation" data-cites="grodstein2006hormone">[@grodstein2006hormone]</span></p>
</div>
</div>
</section>
<section id="standard-medical-advice" class="level2">
<h2 class="anchored" data-anchor-id="standard-medical-advice">Standard Medical Advice</h2>
<div class="nonincremental">
<ul>
<li><p>1992 American College of Obstetricians and Gynecologists </p></li>
<li><p>1992 American College of Physicians </p></li>
<li><p>1993 National Cholesterol Education Program </p></li>
<li><p>1996 American Heart Association </p></li>
</ul>
</div>
</section>
<section id="womens-health-initiative-evaluate-estrogens-experimentally" class="level2">
<h2 class="anchored" data-anchor-id="womens-health-initiative-evaluate-estrogens-experimentally">Women’s Health Initiative: Evaluate Estrogens Experimentally</h2>
<div class="nonincremental">
<ul>
<li><p>Massive <strong>randomised</strong>, double-blind, placebo-controlled trial</p></li>
<li><p>16,000 U.S. women aged 50-79 years</p></li>
<li><p>Assigned to Estrogen plus Progestin therapy</p></li>
<li><p>Women followed approximately every year for up to 8 years.</p></li>
</ul>
</div>
</section>
<section id="findings-clear-discrepancy" class="level2">
<h2 class="anchored" data-anchor-id="findings-clear-discrepancy">Findings: <strong>Clear Discrepancy</strong></h2>
<div class="callout callout-style-default callout-warning no-icon callout-titled" title="Experimental Findings: **opposite of observational findings**">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Warning</span>Experimental Findings: <strong>opposite of observational findings</strong>
</div>
</div>
<div class="callout-body-container callout-body">
<p>All-cause mortality Hazard Ratio: <strong>1.23</strong> for initiators vs non-initiators. <span class="citation" data-cites="manson2003estrogen">[@manson2003estrogen]</span></p>
</div>
</div>
</section>
<section id="medical-community-response-reject-all-observational-studies" class="level2">
<h2 class="anchored" data-anchor-id="medical-community-response-reject-all-observational-studies">Medical community response: <strong>Reject</strong> all observational studies</h2>
<div class="nonincremental">
<ul>
<li>Can observational studies ever be trusted?</li>
<li>Should observational studies ever be funded again?</li>
<li></li>
</ul>
</div>
</section>
<section id="what-is-causality" class="level2">
<h2 class="anchored" data-anchor-id="what-is-causality">What is Causality?</h2>
</section>
<section id="david-humes-two-definitions-in-enquiries-1751" class="level2">
<h2 class="anchored" data-anchor-id="david-humes-two-definitions-in-enquiries-1751">David Hume’s Two Definitions in <em>Enquiries</em> (1751)</h2>
<section id="definition-1" class="level3">
<h3 class="anchored" data-anchor-id="definition-1">Definition 1:</h3>
<blockquote class="blockquote">
<p>We may define a cause to be an object followed by another, and where all the objects, similar to the first, are followed by objects similar to the second…</p>
</blockquote>
</section>
<section id="definition-2" class="level3">
<h3 class="anchored" data-anchor-id="definition-2">Definition 2:</h3>
<blockquote class="blockquote">
<p>Or, in other words, where, </p>
</blockquote>
<p><em>Enquiries Concerning Human Understanding, and Concerning the Principles of Morals</em> 1751</p>
</section>
</section>
<section id="our-lives-are-filled-with-what-if-questions" class="level2">
<h2 class="anchored" data-anchor-id="our-lives-are-filled-with-what-if-questions">Our lives are filled with “What If?” questions</h2>
<p><em>[Image: Sliding Doors movie poster - illustrating the “what if” concept]</em></p>
</section>
<section id="section" class="level2">
<h2 class="anchored" data-anchor-id="section"></h2>
<p><em>[Image: Robert Frost poem - “Two roads diverged in a yellow wood”]</em></p>
</section>
<section id="the-fundamental-problem-of-causal-inference" class="level2">
<h2 class="anchored" data-anchor-id="the-fundamental-problem-of-causal-inference"><strong>The Fundamental Problem of Causal Inference</strong></h2>
<p>To <strong>quantify</strong> a causal effect requires a <strong>counterfactual</strong> contrast:</p>
<p><span class="math display">\[\tau_{you} = \Big[Y_{\text{you}}(a =1) - Y_{\text{you}}(a=0)\Big]\]</span></p>
<p>Where, <span class="math inline">\(Y(a)\)</span> denotes the potential outcome under an intervention <span class="math inline">\(A = a\)</span>. Here, we assume a binary intervention. At any time, we may observe the outcome of only </p>
</section>
<section id="however-we-only-observe-facts-not-counterfactuals" class="level2">
<h2 class="anchored" data-anchor-id="however-we-only-observe-facts-not-counterfactuals">However, we only observe <em>facts</em> not <em>counterfactuals</em></h2>
<p><span class="math display">\[
Y_i|A_i = 1 \implies Y_i(0)|A_i = 1~ \textcolor{red}{\text{is counterfactual}}
\]</span></p>
<div class="footer">
<p>“<strong>And sorry I could not travel both. And be one traveller, long I stood</strong> <span class="math inline">\(\dots\)</span>”</p>
</div>
</section>
<section id="average-treatment-effect-in-randomised-controlled-experiments-work-from-assumptions" class="level2">
<h2 class="anchored" data-anchor-id="average-treatment-effect-in-randomised-controlled-experiments-work-from-assumptions">Average Treatment Effect in randomised controlled experiments work from assumptions</h2>
<p><span class="math display">\[
\text{Average Treatment Effect} = \left[ \begin{aligned}
&amp;\left( \underbrace{\mathbb{E}[Y(1)|A = 1]}_{\text{observed}} + \textcolor{cyan}{\underbrace{\mathbb{E}[Y(1)|A = 0]}_{\text{unobserved}}} \right) \\
&amp;- \left( \underbrace{\mathbb{E}[Y(0)|A = 0]}_{\text{observed}} + \textcolor{cyan}{\underbrace{\mathbb{E}[Y(0)|A = 1]}_{\text{unobserved}}} \right)
\end{aligned} \right]
\]</span></p>
</section>
<section id="under-identifying-assumptions-we-may-infer-causal-effects-from-associations" class="level2">
<h2 class="anchored" data-anchor-id="under-identifying-assumptions-we-may-infer-causal-effects-from-associations">Under identifying assumptions, we may infer causal effects from associations</h2>
<p><span class="math display">\[
\text{ATE} = \sum_{l} \left( \mathbb{E}[Y|A=1, \textcolor{cyan}{L=l}] - \mathbb{E}[Y|A=0, \textcolor{cyan}{L=l}] \right) \times \textcolor{cyan}{\Pr(L=l)}
\]</span></p>
<p>Where <span class="math inline">\(L\)</span> is a set of measured covariates and <span class="math inline">\(A\coprod Y(a)|L\)</span></p>
</section>
</section>
<section id="part-2-the-first-self-inflicted-error-the-what-error" class="level1">
<h1><strong>Part 2: The First Self-Inflicted Error: The <em>What</em> Error</strong></h1>
<section id="paradigmatic-concern-confounding-by-common-cause" class="level2">
<h2 class="anchored" data-anchor-id="paradigmatic-concern-confounding-by-common-cause">Paradigmatic Concern: Confounding by Common Cause</h2>
<p><strong>[DAG: Common Cause]</strong> - <em>A confounding variable L causes both treatment A and outcome Y</em></p>
</section>
<section id="where-assumptions-justify-we-may-condition-on-measured-confounders-to-obtain-balance." class="level2">
<h2 class="anchored" data-anchor-id="where-assumptions-justify-we-may-condition-on-measured-confounders-to-obtain-balance.">Where assumptions justify, we may condition on measured confounders to obtain balance.</h2>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">Problem</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Solution</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<p><strong>[DAG: Common Cause]</strong> - <em>A confounding variable L causes both treatment A and outcome Y</em></p>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<p><strong>[DAG: Adjusted for L]</strong> - <em>By conditioning on L, we block the confounding path</em></p>
</div>
</div>
</div>
</section>
</section>
<section id="error-1-what-over-adjustment" class="level1">
<h1>Error 1 – What (over-adjustment)</h1>
<section id="what-error-1-mediator-bias" class="level2">
<h2 class="anchored" data-anchor-id="what-error-1-mediator-bias">“What Error #1”: <strong>Mediator Bias</strong></h2>
<p><strong>[DAG: Mediator Bias]</strong> - <em>Variable L mediates the effect of A on Y (A → L → Y)</em></p>
</section>
<section id="data-generating-process" class="level2">
<h2 class="anchored" data-anchor-id="data-generating-process">Data Generating Process</h2>
<div class="cell" data-layout-align="center" data-tbl-cap="Religious Service (A) → Wealth (L) → Charity (Y). The true direct effect of A on Y is zero.">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)                           <span class="co"># reproducibility</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>n        <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>service  <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(n, <span class="dv">1</span>, <span class="fl">0.5</span>)          <span class="co"># A</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>wealth   <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> service <span class="sc">+</span> <span class="fu">rnorm</span>(n)     <span class="co"># L</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>charity  <span class="ot">&lt;-</span> <span class="fl">1.5</span> <span class="sc">*</span> wealth <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="at">sd =</span> <span class="fl">1.5</span>)  <span class="co"># Y</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>sim1 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(service, wealth, charity)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section>
<section id="model-comparison" class="level2">
<h2 class="anchored" data-anchor-id="model-comparison">Model comparison</h2>
<div class="cell" data-layout-align="center" data-tbl-cap="Controlling for the mediator reverses the sign of the service coefficient.">
<div class="cell-output-display">
<div id="gnvxvysfyx" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#gnvxvysfyx table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#gnvxvysfyx thead, #gnvxvysfyx tbody, #gnvxvysfyx tfoot, #gnvxvysfyx tr, #gnvxvysfyx td, #gnvxvysfyx th {
  border-style: none;
}

#gnvxvysfyx p {
  margin: 0;
  padding: 0;
}

#gnvxvysfyx .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#gnvxvysfyx .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#gnvxvysfyx .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#gnvxvysfyx .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#gnvxvysfyx .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#gnvxvysfyx .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#gnvxvysfyx .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#gnvxvysfyx .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#gnvxvysfyx .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#gnvxvysfyx .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#gnvxvysfyx .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#gnvxvysfyx .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#gnvxvysfyx .gt_spanner_row {
  border-bottom-style: hidden;
}

#gnvxvysfyx .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#gnvxvysfyx .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#gnvxvysfyx .gt_from_md > :first-child {
  margin-top: 0;
}

#gnvxvysfyx .gt_from_md > :last-child {
  margin-bottom: 0;
}

#gnvxvysfyx .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#gnvxvysfyx .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#gnvxvysfyx .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#gnvxvysfyx .gt_row_group_first td {
  border-top-width: 2px;
}

#gnvxvysfyx .gt_row_group_first th {
  border-top-width: 2px;
}

#gnvxvysfyx .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#gnvxvysfyx .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#gnvxvysfyx .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#gnvxvysfyx .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#gnvxvysfyx .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#gnvxvysfyx .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#gnvxvysfyx .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#gnvxvysfyx .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#gnvxvysfyx .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#gnvxvysfyx .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#gnvxvysfyx .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#gnvxvysfyx .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#gnvxvysfyx .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#gnvxvysfyx .gt_left {
  text-align: left;
}

#gnvxvysfyx .gt_center {
  text-align: center;
}

#gnvxvysfyx .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#gnvxvysfyx .gt_font_normal {
  font-weight: normal;
}

#gnvxvysfyx .gt_font_bold {
  font-weight: bold;
}

#gnvxvysfyx .gt_font_italic {
  font-style: italic;
}

#gnvxvysfyx .gt_super {
  font-size: 65%;
}

#gnvxvysfyx .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#gnvxvysfyx .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#gnvxvysfyx .gt_indent_1 {
  text-indent: 5px;
}

#gnvxvysfyx .gt_indent_2 {
  text-indent: 10px;
}

#gnvxvysfyx .gt_indent_3 {
  text-indent: 15px;
}

#gnvxvysfyx .gt_indent_4 {
  text-indent: 20px;
}

#gnvxvysfyx .gt_indent_5 {
  text-indent: 25px;
}

#gnvxvysfyx .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#gnvxvysfyx div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-bootstrap="false">
<caption>Controlling for the mediator reverses the sign of the service coefficient.</caption>
<colgroup>
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
</colgroup>
<thead>
<tr class="gt_col_headings gt_spanner_row header">
<th rowspan="2" id="label" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"><strong>Characteristic</strong></th>
<th colspan="3" id="level 1; estimate_1" class="gt_center gt_columns_top_border gt_column_spanner_outer" data-quarto-table-cell-role="th" scope="colgroup"><div class="gt_column_spanner">
Model A: Omit L
</div></th>
<th colspan="3" id="level 1; estimate_2" class="gt_center gt_columns_top_border gt_column_spanner_outer" data-quarto-table-cell-role="th" scope="colgroup"><div class="gt_column_spanner">
Model B: Control for L
</div></th>
</tr>
<tr class="gt_col_headings even">
<th id="estimate_1" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>Beta</strong></th>
<th id="conf.low_1" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>95% CI</strong></th>
<th id="p.value_1" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>p-value</strong></th>
<th id="estimate_2" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>Beta</strong></th>
<th id="conf.low_2" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>95% CI</strong></th>
<th id="p.value_2" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>p-value</strong></th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="label">service</td>
<td class="gt_row gt_center" headers="estimate_1">2.9</td>
<td class="gt_row gt_center" headers="conf.low_1">2.6, 3.2</td>
<td class="gt_row gt_center" headers="p.value_1">&lt;0.001</td>
<td class="gt_row gt_center" headers="estimate_2">-0.27</td>
<td class="gt_row gt_center" headers="conf.low_2">-0.53, -0.01</td>
<td class="gt_row gt_center" headers="p.value_2">0.043</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">wealth</td>
<td class="gt_row gt_center" headers="estimate_1"><br>
</td>
<td class="gt_row gt_center" headers="conf.low_1"><br>
</td>
<td class="gt_row gt_center" headers="p.value_1"><br>
</td>
<td class="gt_row gt_center" headers="estimate_2">1.6</td>
<td class="gt_row gt_center" headers="conf.low_2">1.5, 1.7</td>
<td class="gt_row gt_center" headers="p.value_2">&lt;0.001</td>
</tr>
</tbody><tfoot class="gt_sourcenotes">
<tr class="odd">
<td colspan="7" class="gt_sourcenote">Abbreviation: CI = Confidence Interval</td>
</tr>
</tfoot>

</table>

</div>
</div>
</div>
</section>
<section id="which-model-looks-better" class="level2">
<h2 class="anchored" data-anchor-id="which-model-looks-better">Which model looks better?</h2>
<div class="cell" data-layout-align="center" data-tbl-cap="Model B wins on BIC and R² – yet its causal estimate is wrong.">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(performance)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">compare_performance</span>(fit_adjust, fit_omit, <span class="at">rank =</span> <span class="cn">TRUE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Comparison of Model Performance Indices

Name       | Model |    R2 | R2 (adj.) |  RMSE | Sigma | AIC weights
--------------------------------------------------------------------
fit_adjust |    lm | 0.682 |     0.682 | 1.473 | 1.475 |        1.00
fit_omit   |    lm | 0.312 |     0.311 | 2.169 | 2.171 |   2.88e-168

Name       | AICc weights | BIC weights | Performance-Score
-----------------------------------------------------------
fit_adjust |         1.00 |        1.00 |           100.00%
fit_omit   |    2.91e-168 |   3.35e-167 |             0.00%</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># BIC(fit_adjust) - BIC(fit_omit)  # negative → "better" fit</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section>
<section id="what-error-2-collider-bias" class="level2">
<h2 class="anchored" data-anchor-id="what-error-2-collider-bias">“What Error #2”: Collider Bias</h2>
<p><strong>[DAG: Collider Bias]</strong> - <em>Variable L is caused by both A and Y (A → L ← Y)</em></p>
</section>
<section id="data-generating-process-1" class="level2">
<h2 class="anchored" data-anchor-id="data-generating-process-1">Data Generating Process</h2>
<div class="cell" data-layout-align="center" data-tbl-cap="Religious service (A) ← wealth (L) → donations (Y). A and Y are _independent_ in truth.">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2025</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>n          <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>service    <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(n, <span class="dv">1</span>, <span class="fl">0.5</span>)                            <span class="co"># A</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>donations  <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n)                                     <span class="co"># Y</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>wealth     <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> service <span class="sc">+</span> donations, <span class="at">sd =</span> <span class="dv">1</span>) <span class="co"># collider L</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>sim2 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(service, wealth, donations)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section>
<section id="model-comparison-1" class="level2">
<h2 class="anchored" data-anchor-id="model-comparison-1">Model Comparison</h2>
<div class="cell" data-layout-align="center" data-tbl-cap="Adding the collider creates a spurious, significant effect of A.">
<div class="cell-output-display">
<div id="ulqkdjkdva" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#ulqkdjkdva table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#ulqkdjkdva thead, #ulqkdjkdva tbody, #ulqkdjkdva tfoot, #ulqkdjkdva tr, #ulqkdjkdva td, #ulqkdjkdva th {
  border-style: none;
}

#ulqkdjkdva p {
  margin: 0;
  padding: 0;
}

#ulqkdjkdva .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ulqkdjkdva .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#ulqkdjkdva .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ulqkdjkdva .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ulqkdjkdva .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ulqkdjkdva .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ulqkdjkdva .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ulqkdjkdva .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ulqkdjkdva .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ulqkdjkdva .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ulqkdjkdva .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ulqkdjkdva .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ulqkdjkdva .gt_spanner_row {
  border-bottom-style: hidden;
}

#ulqkdjkdva .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#ulqkdjkdva .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ulqkdjkdva .gt_from_md > :first-child {
  margin-top: 0;
}

#ulqkdjkdva .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ulqkdjkdva .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ulqkdjkdva .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#ulqkdjkdva .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#ulqkdjkdva .gt_row_group_first td {
  border-top-width: 2px;
}

#ulqkdjkdva .gt_row_group_first th {
  border-top-width: 2px;
}

#ulqkdjkdva .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ulqkdjkdva .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#ulqkdjkdva .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#ulqkdjkdva .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ulqkdjkdva .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ulqkdjkdva .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ulqkdjkdva .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#ulqkdjkdva .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ulqkdjkdva .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ulqkdjkdva .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ulqkdjkdva .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ulqkdjkdva .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ulqkdjkdva .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ulqkdjkdva .gt_left {
  text-align: left;
}

#ulqkdjkdva .gt_center {
  text-align: center;
}

#ulqkdjkdva .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ulqkdjkdva .gt_font_normal {
  font-weight: normal;
}

#ulqkdjkdva .gt_font_bold {
  font-weight: bold;
}

#ulqkdjkdva .gt_font_italic {
  font-style: italic;
}

#ulqkdjkdva .gt_super {
  font-size: 65%;
}

#ulqkdjkdva .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#ulqkdjkdva .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#ulqkdjkdva .gt_indent_1 {
  text-indent: 5px;
}

#ulqkdjkdva .gt_indent_2 {
  text-indent: 10px;
}

#ulqkdjkdva .gt_indent_3 {
  text-indent: 15px;
}

#ulqkdjkdva .gt_indent_4 {
  text-indent: 20px;
}

#ulqkdjkdva .gt_indent_5 {
  text-indent: 25px;
}

#ulqkdjkdva .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#ulqkdjkdva div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-bootstrap="false">
<caption>Adding the collider creates a spurious, significant effect of A.</caption>
<colgroup>
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
</colgroup>
<thead>
<tr class="gt_col_headings gt_spanner_row header">
<th rowspan="2" id="label" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"><strong>Characteristic</strong></th>
<th colspan="3" id="level 1; estimate_1" class="gt_center gt_columns_top_border gt_column_spanner_outer" data-quarto-table-cell-role="th" scope="colgroup"><div class="gt_column_spanner">
Model A: Omit L
</div></th>
<th colspan="3" id="level 1; estimate_2" class="gt_center gt_columns_top_border gt_column_spanner_outer" data-quarto-table-cell-role="th" scope="colgroup"><div class="gt_column_spanner">
Model B: Control for L (collider)
</div></th>
</tr>
<tr class="gt_col_headings even">
<th id="estimate_1" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>Beta</strong></th>
<th id="conf.low_1" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>95% CI</strong></th>
<th id="p.value_1" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>p-value</strong></th>
<th id="estimate_2" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>Beta</strong></th>
<th id="conf.low_2" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>95% CI</strong></th>
<th id="p.value_2" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>p-value</strong></th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="label">service</td>
<td class="gt_row gt_center" headers="estimate_1">0.00</td>
<td class="gt_row gt_center" headers="conf.low_1">-0.12, 0.13</td>
<td class="gt_row gt_center" headers="p.value_1">&gt;0.9</td>
<td class="gt_row gt_center" headers="estimate_2">-0.53</td>
<td class="gt_row gt_center" headers="conf.low_2">-0.63, -0.44</td>
<td class="gt_row gt_center" headers="p.value_2">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">wealth</td>
<td class="gt_row gt_center" headers="estimate_1"><br>
</td>
<td class="gt_row gt_center" headers="conf.low_1"><br>
</td>
<td class="gt_row gt_center" headers="p.value_1"><br>
</td>
<td class="gt_row gt_center" headers="estimate_2">0.51</td>
<td class="gt_row gt_center" headers="conf.low_2">0.48, 0.54</td>
<td class="gt_row gt_center" headers="p.value_2">&lt;0.001</td>
</tr>
</tbody><tfoot class="gt_sourcenotes">
<tr class="odd">
<td colspan="7" class="gt_sourcenote">Abbreviation: CI = Confidence Interval</td>
</tr>
</tfoot>

</table>

</div>
</div>
</div>
</section>
<section id="which-model-looks-better-1" class="level2">
<h2 class="anchored" data-anchor-id="which-model-looks-better-1">Which model looks better?</h2>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">compare_performance</span>(fit_biased, fit_correct, <span class="at">rank =</span> <span class="cn">TRUE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Comparison of Model Performance Indices

Name        | Model |        R2 |  R2 (adj.) |  RMSE | Sigma | AIC weights
--------------------------------------------------------------------------
fit_biased  |    lm |     0.526 |      0.525 | 0.707 | 0.708 |        1.00
fit_correct |    lm | 3.722e-06 | -9.983e-04 | 1.028 | 1.029 |   1.42e-162

Name        | AICc weights | BIC weights | Performance-Score
------------------------------------------------------------
fit_biased  |         1.00 |        1.00 |           100.00%
fit_correct |    1.43e-162 |   1.65e-161 |             0.00%</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">BIC</span>(fit_biased) <span class="sc">-</span> <span class="fu">BIC</span>(fit_correct)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -740.425</code></pre>
</div>
</div>
</section>
<section id="take-home" class="level2">
<h2 class="anchored" data-anchor-id="take-home">Take-Home</h2>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>Relying on model fit perpetuates the <em>causality crisis</em> in psychology <span class="citation" data-cites="bulbulia2022">[@bulbulia2022]</span>.<br>
Draw the DAG first; decide what belongs in the model before looking at numbers.</p>
</div>
</div>
</section>
<section id="the-what-error-is-widespread-in-experimental-studies-in-the-social-sciences" class="level2">
<h2 class="anchored" data-anchor-id="the-what-error-is-widespread-in-experimental-studies-in-the-social-sciences">The What Error is widespread in <strong>experimental</strong> studies in the social sciences</h2>
<ul>
<li><p>“Overall, we find that <strong>46.7% of the experimental studies</strong> published in APSR, AJPS, and JOP from 2012 to 2014 engaged in posttreatment conditioning (35 of 75 studies) …”</p></li>
<li><p>“About <strong>1 in 4 drop cases or subset the data based on post-treatment criteria,</strong> and <strong>nearly a third include post-treatment variables as covariates</strong>”</p></li>
<li><p>“Most tellingly, <strong>nearly 1 in 8 articles directly conditions on variables that the authors themselves show as being an outcome of the experiment</strong> – an unambiguous indicator of <strong>a fundamental lack of understanding … that conditioning on posttreatment variables can invalidate results from randomized experiments.</strong>”</p></li>
<li><p>“Empirically, then, the answer to the question of <strong>whether the discipline already understands posttreatment bias is clear: It does not.</strong>” <span class="citation" data-cites="montgomery2018">[@montgomery2018]</span></p></li>
</ul>
</section>
<section id="mediator-bias-control-strategy-longitudinal-hygiene" class="level2">
<h2 class="anchored" data-anchor-id="mediator-bias-control-strategy-longitudinal-hygiene">Mediator Bias control strategy: <strong>Longitudinal Hygiene</strong></h2>
<div class="columns">
<div class="column" style="width:50%;">
<p><span class="math display">\[
\mediatorT
\]</span></p>
</div><div class="column" style="width:50%;">
<p><span class="math display">\[
\commoncausesolvedT
\]</span></p>
</div>
</div>
</section>
<section id="how-to-tame-the-what-error-hide-your-future" class="level2">
<h2 class="anchored" data-anchor-id="how-to-tame-the-what-error-hide-your-future">How to Tame The What Error? <strong>Hide your future</strong></h2>
<p>Use Repeated Measures on the Same Individuals</p>
</section>
<section id="collider-bias-control-strategy-hide-your-future" class="level2">
<h2 class="anchored" data-anchor-id="collider-bias-control-strategy-hide-your-future">Collider bias control strategy: <strong>Hide your future</strong></h2>
<div class="columns">
<div class="column" style="width:50%;">
<p><span class="math display">\[\colliderT\]</span></p>
</div><div class="column" style="width:50%;">
<p><span class="math display">\[\commoncausesolvedT\]</span></p>
</div>
</div>
</section>
<section id="collider-bias-by-proxy-control-strategy-hide-your-future" class="level2">
<h2 class="anchored" data-anchor-id="collider-bias-by-proxy-control-strategy-hide-your-future">Collider bias by proxy control strategy: <strong>Hide your future</strong></h2>
<div class="columns">
<div class="column" style="width:50%;">
<p><span class="math display">\[\commoncausechildT\]</span></p>
</div><div class="column" style="width:50%;">
<p><span class="math display">\[\commoncausesolvedchildT\]</span></p>
</div>
</div>
</section>
<section id="post-exposure-collider-bias-control-strategy-hide-your-future" class="level2">
<h2 class="anchored" data-anchor-id="post-exposure-collider-bias-control-strategy-hide-your-future">Post-exposure collider bias control strategy: <strong>Hide your future</strong></h2>
<div class="columns">
<div class="column" style="width:50%;">
<p><span class="math display">\[\mediatorcolliderT\]</span></p>
</div><div class="column" style="width:50%;">
<p><span class="math display">\[\commoncausesolvedT\]</span></p>
</div>
</div>
</section>
<section id="finally-our-biggest-worry-unmeasured-common-causes" class="level2">
<h2 class="anchored" data-anchor-id="finally-our-biggest-worry-unmeasured-common-causes">Finally, our biggest worry: <strong>Unmeasured Common Causes</strong></h2>
<p><span class="math display">\[\downstreamT\]</span></p>
</section>
<section id="unmeasured-common-cause-strategy-hide-your-future" class="level2">
<h2 class="anchored" data-anchor-id="unmeasured-common-cause-strategy-hide-your-future">Unmeasured common cause strategy: <strong>Hide your future</strong></h2>
<div class="columns">
<div class="column" style="width:50%;">
<p><span class="math display">\[\downstreamT\]</span></p>
</div><div class="column" style="width:50%;">
<p><span class="math display">\[\commoncausesolvedT\]</span></p>
</div>
</div>
<p>And because , we should consistently report sensitivity analyses.</p>
<!-- The E-value is the minimum strength of association, on the risk ratio scale, that an unmeasured confounder would need to have with both the treatment and the outcome, conditional on the measured covariates, to explain away treatment–outcome association. -->
</section>
<section id="are-longitudinal-data-sensitivity-analysis-enough" class="level2">
<h2 class="anchored" data-anchor-id="are-longitudinal-data-sensitivity-analysis-enough">Are longitudinal data + sensitivity analysis enough?</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p>If the data we collect were like this: <span class="math display">\[Y_{\text{time 0}} ~~...~~ A_{\text{time 1}}\]</span></p>
</div><div class="column" style="width:50%;">
<p>We should not be tempted to model this.</p>
<p><span class="math display">\[\ytoacrazyT\]</span></p>
</div>
</div>
</section>
<section id="are-longitudinal-data-sensitivity-analysis-enough-1" class="level2">
<h2 class="anchored" data-anchor-id="are-longitudinal-data-sensitivity-analysis-enough-1">Are longitudinal data + sensitivity analysis enough?</h2>
<p> this is wrong?</p>
<p><span class="math display">\[\ytoacrazyT\]</span></p>
</section>
</section>
<section id="error-2-when-time-zero" class="level1">
<h1>Error 2: When (time-zero)</h1>
<section id="longitudinal-data-are-not-enough" class="level2">
<h2 class="anchored" data-anchor-id="longitudinal-data-are-not-enough"><strong>Longitudinal data</strong> are <strong>not</strong> enough</h2>
<p>Temporal ordering was with the observational hormone studies in the 80s/90s that modelled .</p>
<p><strong>How?</strong></p>
</section>
<section id="researchers-failed-to-emulate-an-experiment-in-their-data-target-trial" class="level2">
<h2 class="anchored" data-anchor-id="researchers-failed-to-emulate-an-experiment-in-their-data-target-trial">Researchers failed to emulate an experiment in their data (Target Trial)</h2>
<ul>
<li><p>Women’s Health Initiative: overall hazard ratio 1.23 (0.99, 1.53)</p></li>
<li><p>Women’s Health Initiative: when broken down by years to follow-up:</p>
<ul>
<li>0-2 years 1.51 (1.06, 2.14)</li>
<li>2-5 years 1.31 (0.93, 1.83)</li>
<li>5 or more years <strong>0.67 (0.41, 1.09)</strong></li>
</ul></li>
</ul>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="Survivor Bias.">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Survivor Bias.
</div>
</div>
<div class="callout-body-container callout-body">
<p>The observational results can be </p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="Emulating a target trial with observational data recovers experimental effects.">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Emulating a target trial with observational data recovers experimental effects.
</div>
</div>
<div class="callout-body-container callout-body">
<p>Re-modelling recovers experimental findings <span class="citation" data-cites="hernan2016">[@hernan2016]</span>.</p>
</div>
</div>
</section>
<section id="visualising-the-when-error" class="level2">
<h2 class="anchored" data-anchor-id="visualising-the-when-error">Visualising the When Error</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-time-zero-3lines" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-time-zero-3lines-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="discussion-points_files/figure-html/fig-time-zero-3lines-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-time-zero-3lines-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Three ways to start the clock. Only one is right.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="target-trial-check-list" class="level2">
<h2 class="anchored" data-anchor-id="target-trial-check-list">Target Trial Check List</h2>
<div class="cell" data-layout-align="center">
<div id="tbl-target-trial" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-layout-align="center">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-target-trial-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1: Target-trial specification for the hormone-therapy example.
</figcaption>
<div aria-describedby="tbl-target-trial-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="table do-not-create-environment cell caption-top table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">element</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">definition</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Eligibility</td>
<td style="text-align: left;">Post-menopausal women aged 50–79, no prior CHD</td>
</tr>
<tr class="even">
<td style="text-align: left;">Treatment</td>
<td style="text-align: left;">Initiate oestrogen + progestin on day of Rx pickup</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Comparison</td>
<td style="text-align: left;">No hormone-therapy initiation on that day</td>
</tr>
<tr class="even">
<td style="text-align: left;">Outcome</td>
<td style="text-align: left;">All-cause mortality</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Follow-up</td>
<td style="text-align: left;">8 years or until death / loss to follow-up</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
</section>
</section>
<section id="error-3-who-population-and-heterogeneity" class="level1">
<h1>Error 3 – Who (population and heterogeneity)</h1>
<section id="illustration" class="level2">
<h2 class="anchored" data-anchor-id="illustration">Illustration</h2>
</section>
</section>
<section id="new-zealand-attitudes-and-values-study-nzavs-a-step-by-step-workflow-for-causal-inference" class="level1">
<h1>New Zealand Attitudes and Values Study (NZAVS): A step-by-step workflow for causal inference</h1>
<section id="the-new-zealand-attitudes-and-values-study" class="level2">
<h2 class="anchored" data-anchor-id="the-new-zealand-attitudes-and-values-study">The New Zealand Attitudes and Values Study:</h2>
<ul>
<li><p>Planned 20-year longitudinal study, currently in its 14th year, &gt; 77k measured</p></li>
<li><p>Sample frame is drawn randomly from the NZ Electoral Roll.</p></li>
</ul>
</section>
<section id="causal-questions" class="level2">
<h2 class="anchored" data-anchor-id="causal-questions">Causal Questions</h2>
<ol type="1">
<li><p>Average Treatment Effect: Difference in averages of social outcomes (a) if everyone in New Zealand were to attend religious service at least 1x per month (b) if everyone were not to attend religious service at all.</p></li>
<li><p>Heterogeneous Treatment Effects: Machine learning of groups who differ in such effects. Focus here on Qini Curve at 20% and 30% of full “budget”.</p></li>
<li><p>Use Qini results to select for Policy Trees: Clarify <em>who</em> responds strongly/weakly.</p></li>
</ol>
<p><strong>Note: all results use “honest” learning – sample is split into training/test sets (here 70/30).</strong></p>
</section>
<section id="outcomes" class="level2">
<h2 class="anchored" data-anchor-id="outcomes">Outcomes</h2>
<ol type="1">
<li>Sense of Belonging</li>
<li>Social Support</li>
<li>Charitable Donations (annual)</li>
<li>Volunteering (weekly)</li>
</ol>
<p><strong>All outcomes measured one year after the intervention</strong></p>
</section>
<section id="three-wave-panel-design-control-for-baseline-exposure-and-outcome-among-confounder-set." class="level2">
<h2 class="anchored" data-anchor-id="three-wave-panel-design-control-for-baseline-exposure-and-outcome-among-confounder-set.">Three-wave Panel Design: control for baseline exposure and outcome among confounder set.</h2>
<p><span class="math display">\[
\threeLONG
\]</span></p>
</section>
<section id="target-population-residents-of-new-zealand-in-2018-had-they-not-been-censored-through-2021." class="level2">
<h2 class="anchored" data-anchor-id="target-population-residents-of-new-zealand-in-2018-had-they-not-been-censored-through-2021.">Target Population: Residents of New Zealand in 2018 had they not been censored through 2021.</h2>
<section id="census-weights-age-x-gender-x-ethnicity" class="level3">
<h3 class="anchored" data-anchor-id="census-weights-age-x-gender-x-ethnicity">Census Weights (Age X Gender X Ethnicity)</h3>
<p><img src="hist_sample_weights.png" class="img-fluid"></p>
</section>
<section id="ipcw-stabilised-trimmed" class="level3">
<h3 class="anchored" data-anchor-id="ipcw-stabilised-trimmed">(IPCW Stabilised &amp; Trimmed)</h3>
<p><img src="hist_combo_weights.png" class="img-fluid"></p>
</section>
</section>
<section id="religious-service-intervention" class="level2">
<h2 class="anchored" data-anchor-id="religious-service-intervention">Religious Service Intervention</h2>
<p><span class="math display">\[f(A) = \begin{cases} 1 &amp; \text{if } a \ge 0 \text{ At least 1 x per month Religious Attendance} \\ 0 &amp; \text{if } a = 0 \text{ Monthly Religious Service} \end{cases}\]</span></p>
</section>
<section id="histogram-showing-split" class="level2">
<h2 class="anchored" data-anchor-id="histogram-showing-split">Histogram Showing Split</h2>
<p><img src="2025_church_graph_cut.png" class="img-fluid"></p>
</section>
<section id="love-plot-of-propensity-scores" class="level2">
<h2 class="anchored" data-anchor-id="love-plot-of-propensity-scores">Love Plot of Propensity Scores</h2>
<p><img src="2025_church_propensity.png" class="img-fluid"></p>
</section>
<section id="average-treatment-effect-results" class="level2">
<h2 class="anchored" data-anchor-id="average-treatment-effect-results">Average Treatment Effect Results:</h2>
</section>
<section id="workflow" class="level2">
<h2 class="anchored" data-anchor-id="workflow">Workflow</h2>
<ul>
<li>Target population: New Zealand Population by 2018 census weights</li>
<li>Outcomes: all NZAVS outcomes relating to pro-sociality (outcome-wide study)</li>
<li>Missing data: inverse-probability of censoring weights non-parametrically estimated/ causal forests permit missing data at baseline</li>
<li>Eligibility: participated in NZAVS 2018 (wave-10) and 2019 (wave 11, exposure wave) may have been lost to follow-up in wave 12, <strong>46,377</strong>.</li>
<li>Bonferroni correct for multiple comparisons / E-value threshold = 1.2</li>
</ul>
</section>
<section id="transition-table-religious-attendance" class="level2">
<h2 class="anchored" data-anchor-id="transition-table-religious-attendance">Transition table: Religious Attendance</h2>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: left;">From / To</th>
<th style="text-align: right;">State 0</th>
<th style="text-align: right;">State 1</th>
<th style="text-align: right;">Total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">State 0</td>
<td style="text-align: right;">28545</td>
<td style="text-align: right;">681</td>
<td style="text-align: right;">29226</td>
</tr>
<tr class="even">
<td style="text-align: left;">State 1</td>
<td style="text-align: right;">887</td>
<td style="text-align: right;">3593</td>
<td style="text-align: right;">4480</td>
</tr>
</tbody>
</table>
</section>
<section id="average-treatment-effect" class="level2">
<h2 class="anchored" data-anchor-id="average-treatment-effect">Average Treatment Effect</h2>
<p>The following outcomes showed reliable causal evidence (E‑value lower bound &gt; 1.2): - Volunteering (weekly, log): 0.154(0.056,0.252); on the original scale, 11.264 minutes(3.943,19.158). E‑value bound = 1.287 - log Charity Donate: 0.13(0.045,0.215); on the original scale, 39.935 (12.247,74.883). E‑value bound = 1.25</p>
</section>
</section>
<section id="graph-ate" class="level1">
<h1>Graph ATE</h1>
<p><img src="2025_church_ate.png" class="img-fluid"></p>
<section id="how-much-better-if-we-treated-by-cate" class="level2">
<h2 class="anchored" data-anchor-id="how-much-better-if-we-treated-by-cate">How Much Better if We Treated by CATE?</h2>
<p><img src="2025_church_combined_qini.png" class="img-fluid"></p>
</section>
<section id="who-should-we-treat-first-belonging" class="level2">
<h2 class="anchored" data-anchor-id="who-should-we-treat-first-belonging">Who Should We Treat First? Belonging</h2>
<p><img src="2025_2L_church_on_belonging.png" class="img-fluid"></p>
</section>
<section id="who-should-we-treat-first-charitable-donations" class="level2">
<h2 class="anchored" data-anchor-id="who-should-we-treat-first-charitable-donations">Who Should We Treat First? Charitable Donations</h2>
<p><img src="2025_2L_church_on_charity_donations.png" class="img-fluid"></p>
</section>
<section id="closing" class="level2">
<h2 class="anchored" data-anchor-id="closing">Closing</h2>
<table class="caption-top table">
<colgroup>
<col style="width: 11%">
<col style="width: 35%">
<col style="width: 53%">
</colgroup>
<thead>
<tr class="header">
<th><strong>Error</strong></th>
<th><strong>Need</strong></th>
<th><strong>Remedy</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>What</td>
<td>Control the right variables</td>
<td>Draw a DAG first</td>
</tr>
<tr class="even">
<td>When</td>
<td>Start the clock on time</td>
<td>Emulate a target trial</td>
</tr>
<tr class="odd">
<td>Who</td>
<td>Treat the right people</td>
<td>Weight to target + investigate heterogeneity</td>
</tr>
</tbody>
</table>
<!-- 3. Emulating experiments tend to \color{cyan}{attenuate results}. -->
</section>
<section id="thanks" class="level2 nonincremental">
<h2 class="nonincremental anchored" data-anchor-id="thanks">Thanks</h2>
<div class="nonincremental">
<ul>
<li>TRT Grant 0418 &amp; Max Planck Institute for Evolutionary Anthropology for support.</li>
<li>Chris G. Sibley (NZAVS lead Investigator) for the heavy data lifting</li>
<li>77,490 NZAVS participants for their time</li>
<li> with questions or if you would like to become involved: </li>
</ul>
</div>
<hr>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="NZAVS-QR.png" class="img-fluid figure-img"></p>
<figcaption>NZAVS</figcaption>
</figure>
</div>
</section>
<section id="section-1" class="level2">
<h2 class="anchored" data-anchor-id="section-1"></h2>
<div class="refs">

</div>


<!-- -->

</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    // Ensure there is a toggle, if there isn't float one in the top right
    if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
      const a = window.document.createElement('a');
      a.classList.add('top-right');
      a.classList.add('quarto-color-scheme-toggle');
      a.href = "";
      a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
      const i = window.document.createElement("i");
      i.classList.add('bi');
      a.appendChild(i);
      window.document.body.appendChild(a);
    }
    setColorSchemeToggle(hasAlternateSentinel())
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/go-bayes\.github\.io\/epic-lab\/");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
            // target, if specified
            link.setAttribute("target", "_blank");
            if (link.getAttribute("rel") === null) {
              link.setAttribute("rel", "noopener");
            }
            // default icon
            link.classList.add("external");
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb10" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Self-Inflicted Injuries in Causal Inference"</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="an">subtitle:</span><span class="co"> "Common Errors in Observational Studies"</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> </span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="co">  - name: Joseph A. Bulbulia</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="co">    affiliation: Victoria University of Wellington, New Zealand</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="co">    orcid: 0000-0002-5861-2056</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="co">    email: joseph.bulbulia@vuw.ac.nz</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> 2025-08-12</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="an">editor_options:</span><span class="co"> </span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="co">  chunk_output_type: console</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: load_libraries</span></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a><span class="co"># load required libraries</span></span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gtsummary)</span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom.helpers)</span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(performance)</span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a><span class="co"># set theme for plots</span></span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_minimal</span>())</span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-35"><a href="#cb10-35" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(</span>
<span id="cb10-36"><a href="#cb10-36" aria-hidden="true" tabindex="-1"></a>  <span class="at">fig.width=</span><span class="dv">9</span>,</span>
<span id="cb10-37"><a href="#cb10-37" aria-hidden="true" tabindex="-1"></a>  <span class="at">fig.asp =</span> <span class="fl">0.5625</span>,</span>
<span id="cb10-38"><a href="#cb10-38" aria-hidden="true" tabindex="-1"></a>  <span class="at">out.width =</span> <span class="st">"0.9</span><span class="sc">\\</span><span class="st">linewidth"</span>,</span>
<span id="cb10-39"><a href="#cb10-39" aria-hidden="true" tabindex="-1"></a>  <span class="at">fig.align =</span> <span class="st">"center"</span>,</span>
<span id="cb10-40"><a href="#cb10-40" aria-hidden="true" tabindex="-1"></a>  <span class="at">dpi =</span> <span class="dv">300</span></span>
<span id="cb10-41"><a href="#cb10-41" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb10-42"><a href="#cb10-42" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb10-43"><a href="#cb10-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-44"><a href="#cb10-44" aria-hidden="true" tabindex="-1"></a><span class="fu"># **Part 1: Motivating Example**</span></span>
<span id="cb10-45"><a href="#cb10-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-46"><a href="#cb10-46" aria-hidden="true" tabindex="-1"></a><span class="fu">## 1990s observational studies indicated 30% all-cause mortality reduction from estrogen therapies?</span></span>
<span id="cb10-47"><a href="#cb10-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-48"><a href="#cb10-48" aria-hidden="true" tabindex="-1"></a>::: {.callout-note title="In the 1980s and 1990s estrogen treatments appeared to **benefit** postmenopausal women"}</span>
<span id="cb10-49"><a href="#cb10-49" aria-hidden="true" tabindex="-1"></a>Hazard ratio for all-cause mortality: **0.68** current users vs. never users </span>
<span id="cb10-50"><a href="#cb10-50" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">@grodstein2006hormone</span><span class="co">]</span> </span>
<span id="cb10-51"><a href="#cb10-51" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb10-52"><a href="#cb10-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-53"><a href="#cb10-53" aria-hidden="true" tabindex="-1"></a><span class="fu">## Standard Medical Advice</span></span>
<span id="cb10-54"><a href="#cb10-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-55"><a href="#cb10-55" aria-hidden="true" tabindex="-1"></a>::: nonincremental</span>
<span id="cb10-56"><a href="#cb10-56" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>1992 American College of Obstetricians and Gynecologists \textcolor{cyan}{"Probable beneficial effect of estrogens on heart disease."}</span>
<span id="cb10-57"><a href="#cb10-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-58"><a href="#cb10-58" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>1992 American College of Physicians \textcolor{cyan}{"Women who have coronary heart disease or who are at increased risk of coronary heart disease are likely to benefit from hormone therapy."}</span>
<span id="cb10-59"><a href="#cb10-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-60"><a href="#cb10-60" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>1993 National Cholesterol Education Program \textcolor{cyan}{"Epidemiologic evidence for the benefit of estrogen replacement therapy is especially strong for secondary prevention in women with prior CHD."}</span>
<span id="cb10-61"><a href="#cb10-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-62"><a href="#cb10-62" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>1996 American Heart Association \textcolor{cyan}{"ERT does look promising as a long-term protection against heart attack."}</span>
<span id="cb10-63"><a href="#cb10-63" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb10-64"><a href="#cb10-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-65"><a href="#cb10-65" aria-hidden="true" tabindex="-1"></a><span class="fu">## Women's Health Initiative: Evaluate Estrogens Experimentally</span></span>
<span id="cb10-66"><a href="#cb10-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-67"><a href="#cb10-67" aria-hidden="true" tabindex="-1"></a>::: nonincremental</span>
<span id="cb10-68"><a href="#cb10-68" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Massive **randomised**, double-blind, placebo-controlled trial</span>
<span id="cb10-69"><a href="#cb10-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-70"><a href="#cb10-70" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>16,000 U.S. women aged 50-79 years</span>
<span id="cb10-71"><a href="#cb10-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-72"><a href="#cb10-72" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Assigned to Estrogen plus Progestin therapy</span>
<span id="cb10-73"><a href="#cb10-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-74"><a href="#cb10-74" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Women followed approximately every year for up to 8 years.</span>
<span id="cb10-75"><a href="#cb10-75" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb10-76"><a href="#cb10-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-77"><a href="#cb10-77" aria-hidden="true" tabindex="-1"></a><span class="fu">## Findings: **Clear Discrepancy**</span></span>
<span id="cb10-78"><a href="#cb10-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-79"><a href="#cb10-79" aria-hidden="true" tabindex="-1"></a>::: {.callout-warning title="Experimental Findings: **opposite of observational findings**" icon="false"}</span>
<span id="cb10-80"><a href="#cb10-80" aria-hidden="true" tabindex="-1"></a>All-cause mortality Hazard Ratio: **1.23** for initiators vs non-initiators.  <span class="co">[</span><span class="ot">@manson2003estrogen</span><span class="co">]</span></span>
<span id="cb10-81"><a href="#cb10-81" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb10-82"><a href="#cb10-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-83"><a href="#cb10-83" aria-hidden="true" tabindex="-1"></a><span class="fu">## Medical community response: **Reject** all observational studies</span></span>
<span id="cb10-84"><a href="#cb10-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-85"><a href="#cb10-85" aria-hidden="true" tabindex="-1"></a>::: nonincremental</span>
<span id="cb10-86"><a href="#cb10-86" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Can observational studies ever be trusted?</span>
<span id="cb10-87"><a href="#cb10-87" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Should observational studies ever be funded again?</span>
<span id="cb10-88"><a href="#cb10-88" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>\color{cyan}{What went wrong?}</span>
<span id="cb10-89"><a href="#cb10-89" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb10-90"><a href="#cb10-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-91"><a href="#cb10-91" aria-hidden="true" tabindex="-1"></a><span class="fu">## What is Causality?</span></span>
<span id="cb10-92"><a href="#cb10-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-93"><a href="#cb10-93" aria-hidden="true" tabindex="-1"></a><span class="fu">## David Hume's Two Definitions in *Enquiries* (1751)</span></span>
<span id="cb10-94"><a href="#cb10-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-95"><a href="#cb10-95" aria-hidden="true" tabindex="-1"></a><span class="fu">### Definition 1:</span></span>
<span id="cb10-96"><a href="#cb10-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-97"><a href="#cb10-97" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; We may define a cause to be an object followed by another, and where all the objects, similar to the first, are followed by objects similar to the second...</span></span>
<span id="cb10-98"><a href="#cb10-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-99"><a href="#cb10-99" aria-hidden="true" tabindex="-1"></a><span class="fu">### Definition 2:</span></span>
<span id="cb10-100"><a href="#cb10-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-101"><a href="#cb10-101" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Or, in other words, where, \color{cyan}{if the first object had not been, the second never would have existed}</span></span>
<span id="cb10-102"><a href="#cb10-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-103"><a href="#cb10-103" aria-hidden="true" tabindex="-1"></a>*Enquiries Concerning Human Understanding, and Concerning the Principles of Morals* 1751</span>
<span id="cb10-104"><a href="#cb10-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-105"><a href="#cb10-105" aria-hidden="true" tabindex="-1"></a><span class="fu">## Our lives are filled with "What If?" questions</span></span>
<span id="cb10-106"><a href="#cb10-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-107"><a href="#cb10-107" aria-hidden="true" tabindex="-1"></a>*[Image: Sliding Doors movie poster - illustrating the "what if" concept]*</span>
<span id="cb10-108"><a href="#cb10-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-109"><a href="#cb10-109" aria-hidden="true" tabindex="-1"></a><span class="fu">## </span></span>
<span id="cb10-110"><a href="#cb10-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-111"><a href="#cb10-111" aria-hidden="true" tabindex="-1"></a>*[Image: Robert Frost poem - "Two roads diverged in a yellow wood"]*</span>
<span id="cb10-112"><a href="#cb10-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-113"><a href="#cb10-113" aria-hidden="true" tabindex="-1"></a><span class="fu">## **The Fundamental Problem of Causal Inference**</span></span>
<span id="cb10-114"><a href="#cb10-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-115"><a href="#cb10-115" aria-hidden="true" tabindex="-1"></a>To **quantify** a causal effect requires a **counterfactual** contrast:</span>
<span id="cb10-116"><a href="#cb10-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-117"><a href="#cb10-117" aria-hidden="true" tabindex="-1"></a>$$\tau_{you} = \Big<span class="co">[</span><span class="ot">Y_{\text{you}}(a =1) - Y_{\text{you}}(a=0)\Big</span><span class="co">]</span>$$</span>
<span id="cb10-118"><a href="#cb10-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-119"><a href="#cb10-119" aria-hidden="true" tabindex="-1"></a>Where, $Y(a)$ denotes the potential outcome under an intervention $A = a$. Here, we assume a binary intervention. At any time, we may observe the outcome of only \textcolor{red}{one intervention, not both.}</span>
<span id="cb10-120"><a href="#cb10-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-121"><a href="#cb10-121" aria-hidden="true" tabindex="-1"></a><span class="fu">## However, we only observe *facts* not *counterfactuals*</span></span>
<span id="cb10-122"><a href="#cb10-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-123"><a href="#cb10-123" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb10-124"><a href="#cb10-124" aria-hidden="true" tabindex="-1"></a>Y_i|A_i = 1 \implies Y_i(0)|A_i = 1~ \textcolor{red}{\text{is counterfactual}}</span>
<span id="cb10-125"><a href="#cb10-125" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb10-126"><a href="#cb10-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-127"><a href="#cb10-127" aria-hidden="true" tabindex="-1"></a>::: footer</span>
<span id="cb10-128"><a href="#cb10-128" aria-hidden="true" tabindex="-1"></a>"**And sorry I could not travel both. And be one traveller, long I stood** $\dots$"</span>
<span id="cb10-129"><a href="#cb10-129" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb10-130"><a href="#cb10-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-131"><a href="#cb10-131" aria-hidden="true" tabindex="-1"></a><span class="fu">## Average Treatment Effect in randomised controlled experiments work from assumptions</span></span>
<span id="cb10-132"><a href="#cb10-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-133"><a href="#cb10-133" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb10-134"><a href="#cb10-134" aria-hidden="true" tabindex="-1"></a>\text{Average Treatment Effect} = \left[ \begin{aligned}</span>
<span id="cb10-135"><a href="#cb10-135" aria-hidden="true" tabindex="-1"></a>&amp;\left( \underbrace{\mathbb{E}<span class="co">[</span><span class="ot">Y(1)|A = 1</span><span class="co">]</span>}_{\text{observed}} + \textcolor{cyan}{\underbrace{\mathbb{E}[Y(1)|A = 0]}_{\text{unobserved}}} \right) <span class="sc">\\</span></span>
<span id="cb10-136"><a href="#cb10-136" aria-hidden="true" tabindex="-1"></a>&amp;- \left( \underbrace{\mathbb{E}<span class="co">[</span><span class="ot">Y(0)|A = 0</span><span class="co">]</span>}_{\text{observed}} + \textcolor{cyan}{\underbrace{\mathbb{E}[Y(0)|A = 1]}_{\text{unobserved}}} \right)</span>
<span id="cb10-137"><a href="#cb10-137" aria-hidden="true" tabindex="-1"></a>\end{aligned} \right]</span>
<span id="cb10-138"><a href="#cb10-138" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb10-139"><a href="#cb10-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-140"><a href="#cb10-140" aria-hidden="true" tabindex="-1"></a><span class="fu">## Under identifying assumptions, we may infer causal effects from associations</span></span>
<span id="cb10-141"><a href="#cb10-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-142"><a href="#cb10-142" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb10-143"><a href="#cb10-143" aria-hidden="true" tabindex="-1"></a>\text{ATE} = \sum_{l} \left( \mathbb{E}<span class="co">[</span><span class="ot">Y|A=1, \textcolor{cyan}{L=l}</span><span class="co">]</span> - \mathbb{E}<span class="co">[</span><span class="ot">Y|A=0, \textcolor{cyan}{L=l}</span><span class="co">]</span> \right) \times \textcolor{cyan}{\Pr(L=l)}</span>
<span id="cb10-144"><a href="#cb10-144" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb10-145"><a href="#cb10-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-146"><a href="#cb10-146" aria-hidden="true" tabindex="-1"></a>Where $L$ is a set of measured covariates and $A\coprod Y(a)|L$</span>
<span id="cb10-147"><a href="#cb10-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-148"><a href="#cb10-148" aria-hidden="true" tabindex="-1"></a><span class="fu"># **Part 2: The First Self-Inflicted Error: The *What* Error**</span></span>
<span id="cb10-149"><a href="#cb10-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-150"><a href="#cb10-150" aria-hidden="true" tabindex="-1"></a><span class="fu">## Paradigmatic Concern: Confounding by Common Cause</span></span>
<span id="cb10-151"><a href="#cb10-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-152"><a href="#cb10-152" aria-hidden="true" tabindex="-1"></a>**[DAG: Common Cause]** - *A confounding variable L causes both treatment A and outcome Y*</span>
<span id="cb10-153"><a href="#cb10-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-154"><a href="#cb10-154" aria-hidden="true" tabindex="-1"></a><span class="fu">## Where assumptions justify, we may condition on measured confounders to obtain balance.</span></span>
<span id="cb10-155"><a href="#cb10-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-156"><a href="#cb10-156" aria-hidden="true" tabindex="-1"></a>::: {.panel-tabset}</span>
<span id="cb10-157"><a href="#cb10-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-158"><a href="#cb10-158" aria-hidden="true" tabindex="-1"></a><span class="fu">## Problem</span></span>
<span id="cb10-159"><a href="#cb10-159" aria-hidden="true" tabindex="-1"></a>**[DAG: Common Cause]** - *A confounding variable L causes both treatment A and outcome Y*</span>
<span id="cb10-160"><a href="#cb10-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-161"><a href="#cb10-161" aria-hidden="true" tabindex="-1"></a><span class="fu">## Solution</span></span>
<span id="cb10-162"><a href="#cb10-162" aria-hidden="true" tabindex="-1"></a>**[DAG: Adjusted for L]** - *By conditioning on L, we block the confounding path*</span>
<span id="cb10-163"><a href="#cb10-163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-164"><a href="#cb10-164" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb10-165"><a href="#cb10-165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-166"><a href="#cb10-166" aria-hidden="true" tabindex="-1"></a><span class="fu"># Error 1 – What (over-adjustment)</span></span>
<span id="cb10-167"><a href="#cb10-167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-168"><a href="#cb10-168" aria-hidden="true" tabindex="-1"></a><span class="fu">## "What Error #1": **Mediator Bias** </span></span>
<span id="cb10-169"><a href="#cb10-169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-170"><a href="#cb10-170" aria-hidden="true" tabindex="-1"></a>**[DAG: Mediator Bias]** - *Variable L mediates the effect of A on Y (A → L → Y)*</span>
<span id="cb10-171"><a href="#cb10-171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-172"><a href="#cb10-172" aria-hidden="true" tabindex="-1"></a><span class="fu">## Data Generating Process </span></span>
<span id="cb10-173"><a href="#cb10-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-176"><a href="#cb10-176" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb10-177"><a href="#cb10-177" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: sim1-dgp</span></span>
<span id="cb10-178"><a href="#cb10-178" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb10-179"><a href="#cb10-179" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb10-180"><a href="#cb10-180" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Religious Service (A) → Wealth (L) → Charity (Y). The true direct effect of A on Y is zero."</span></span>
<span id="cb10-181"><a href="#cb10-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-182"><a href="#cb10-182" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb10-183"><a href="#cb10-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-184"><a href="#cb10-184" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)                           <span class="co"># reproducibility</span></span>
<span id="cb10-185"><a href="#cb10-185" aria-hidden="true" tabindex="-1"></a>n        <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb10-186"><a href="#cb10-186" aria-hidden="true" tabindex="-1"></a>service  <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(n, <span class="dv">1</span>, <span class="fl">0.5</span>)          <span class="co"># A</span></span>
<span id="cb10-187"><a href="#cb10-187" aria-hidden="true" tabindex="-1"></a>wealth   <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> service <span class="sc">+</span> <span class="fu">rnorm</span>(n)     <span class="co"># L</span></span>
<span id="cb10-188"><a href="#cb10-188" aria-hidden="true" tabindex="-1"></a>charity  <span class="ot">&lt;-</span> <span class="fl">1.5</span> <span class="sc">*</span> wealth <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="at">sd =</span> <span class="fl">1.5</span>)  <span class="co"># Y</span></span>
<span id="cb10-189"><a href="#cb10-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-190"><a href="#cb10-190" aria-hidden="true" tabindex="-1"></a>sim1 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(service, wealth, charity)</span>
<span id="cb10-191"><a href="#cb10-191" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb10-192"><a href="#cb10-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-193"><a href="#cb10-193" aria-hidden="true" tabindex="-1"></a><span class="fu">## Model comparison</span></span>
<span id="cb10-194"><a href="#cb10-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-197"><a href="#cb10-197" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb10-198"><a href="#cb10-198" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: sim1-table</span></span>
<span id="cb10-199"><a href="#cb10-199" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb10-200"><a href="#cb10-200" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb10-201"><a href="#cb10-201" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb10-202"><a href="#cb10-202" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Controlling for the mediator reverses the sign of the service coefficient."</span></span>
<span id="cb10-203"><a href="#cb10-203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-204"><a href="#cb10-204" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gtsummary)</span>
<span id="cb10-205"><a href="#cb10-205" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom.helpers)</span>
<span id="cb10-206"><a href="#cb10-206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-207"><a href="#cb10-207" aria-hidden="true" tabindex="-1"></a>fit_omit   <span class="ot">&lt;-</span> <span class="fu">lm</span>(charity <span class="sc">~</span> service, <span class="at">data =</span> sim1)           <span class="co"># correct</span></span>
<span id="cb10-208"><a href="#cb10-208" aria-hidden="true" tabindex="-1"></a>fit_adjust <span class="ot">&lt;-</span> <span class="fu">lm</span>(charity <span class="sc">~</span> service <span class="sc">+</span> wealth, <span class="at">data =</span> sim1)  <span class="co"># biased</span></span>
<span id="cb10-209"><a href="#cb10-209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-210"><a href="#cb10-210" aria-hidden="true" tabindex="-1"></a><span class="fu">tbl_merge</span>(</span>
<span id="cb10-211"><a href="#cb10-211" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="fu">tbl_regression</span>(fit_omit),</span>
<span id="cb10-212"><a href="#cb10-212" aria-hidden="true" tabindex="-1"></a>       <span class="fu">tbl_regression</span>(fit_adjust)),</span>
<span id="cb10-213"><a href="#cb10-213" aria-hidden="true" tabindex="-1"></a>  <span class="at">tab_spanner =</span> <span class="fu">c</span>(<span class="st">"Model A: Omit L"</span>,</span>
<span id="cb10-214"><a href="#cb10-214" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"Model B: Control for L"</span>)</span>
<span id="cb10-215"><a href="#cb10-215" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb10-216"><a href="#cb10-216" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb10-217"><a href="#cb10-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-218"><a href="#cb10-218" aria-hidden="true" tabindex="-1"></a><span class="fu">## Which model looks better?</span></span>
<span id="cb10-219"><a href="#cb10-219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-222"><a href="#cb10-222" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb10-223"><a href="#cb10-223" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: sim1-metrics</span></span>
<span id="cb10-224"><a href="#cb10-224" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb10-225"><a href="#cb10-225" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb10-226"><a href="#cb10-226" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Model B wins on BIC and R² – yet its causal estimate is wrong."</span></span>
<span id="cb10-227"><a href="#cb10-227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-228"><a href="#cb10-228" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(performance)</span>
<span id="cb10-229"><a href="#cb10-229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-230"><a href="#cb10-230" aria-hidden="true" tabindex="-1"></a><span class="fu">compare_performance</span>(fit_adjust, fit_omit, <span class="at">rank =</span> <span class="cn">TRUE</span>)</span>
<span id="cb10-231"><a href="#cb10-231" aria-hidden="true" tabindex="-1"></a><span class="co"># BIC(fit_adjust) - BIC(fit_omit)  # negative → "better" fit</span></span>
<span id="cb10-232"><a href="#cb10-232" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb10-233"><a href="#cb10-233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-234"><a href="#cb10-234" aria-hidden="true" tabindex="-1"></a><span class="fu">## "What Error #2": Collider Bias </span></span>
<span id="cb10-235"><a href="#cb10-235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-236"><a href="#cb10-236" aria-hidden="true" tabindex="-1"></a>**[DAG: Collider Bias]** - *Variable L is caused by both A and Y (A → L ← Y)*</span>
<span id="cb10-237"><a href="#cb10-237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-238"><a href="#cb10-238" aria-hidden="true" tabindex="-1"></a><span class="fu">## Data Generating Process </span></span>
<span id="cb10-239"><a href="#cb10-239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-242"><a href="#cb10-242" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb10-243"><a href="#cb10-243" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: sim2-dgp</span></span>
<span id="cb10-244"><a href="#cb10-244" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb10-245"><a href="#cb10-245" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb10-246"><a href="#cb10-246" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Religious service (A) ← wealth (L) → donations (Y). A and Y are _independent_ in truth."</span></span>
<span id="cb10-247"><a href="#cb10-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-248"><a href="#cb10-248" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2025</span>)</span>
<span id="cb10-249"><a href="#cb10-249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-250"><a href="#cb10-250" aria-hidden="true" tabindex="-1"></a>n          <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb10-251"><a href="#cb10-251" aria-hidden="true" tabindex="-1"></a>service    <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(n, <span class="dv">1</span>, <span class="fl">0.5</span>)                            <span class="co"># A</span></span>
<span id="cb10-252"><a href="#cb10-252" aria-hidden="true" tabindex="-1"></a>donations  <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n)                                     <span class="co"># Y</span></span>
<span id="cb10-253"><a href="#cb10-253" aria-hidden="true" tabindex="-1"></a>wealth     <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> service <span class="sc">+</span> donations, <span class="at">sd =</span> <span class="dv">1</span>) <span class="co"># collider L</span></span>
<span id="cb10-254"><a href="#cb10-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-255"><a href="#cb10-255" aria-hidden="true" tabindex="-1"></a>sim2 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(service, wealth, donations)</span>
<span id="cb10-256"><a href="#cb10-256" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb10-257"><a href="#cb10-257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-258"><a href="#cb10-258" aria-hidden="true" tabindex="-1"></a><span class="fu">## Model Comparison </span></span>
<span id="cb10-259"><a href="#cb10-259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-262"><a href="#cb10-262" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb10-263"><a href="#cb10-263" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: sim2-table</span></span>
<span id="cb10-264"><a href="#cb10-264" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb10-265"><a href="#cb10-265" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Adding the collider creates a spurious, significant effect of A."</span></span>
<span id="cb10-266"><a href="#cb10-266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-267"><a href="#cb10-267" aria-hidden="true" tabindex="-1"></a>fit_correct <span class="ot">&lt;-</span> <span class="fu">lm</span>(donations <span class="sc">~</span> service, <span class="at">data =</span> sim2)           <span class="co"># correct</span></span>
<span id="cb10-268"><a href="#cb10-268" aria-hidden="true" tabindex="-1"></a>fit_biased  <span class="ot">&lt;-</span> <span class="fu">lm</span>(donations <span class="sc">~</span> service <span class="sc">+</span> wealth, <span class="at">data =</span> sim2)  <span class="co"># biased</span></span>
<span id="cb10-269"><a href="#cb10-269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-270"><a href="#cb10-270" aria-hidden="true" tabindex="-1"></a><span class="fu">tbl_merge</span>(</span>
<span id="cb10-271"><a href="#cb10-271" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="fu">tbl_regression</span>(fit_correct),</span>
<span id="cb10-272"><a href="#cb10-272" aria-hidden="true" tabindex="-1"></a>       <span class="fu">tbl_regression</span>(fit_biased)),</span>
<span id="cb10-273"><a href="#cb10-273" aria-hidden="true" tabindex="-1"></a>  <span class="at">tab_spanner =</span> <span class="fu">c</span>(<span class="st">"Model A: Omit L"</span>,</span>
<span id="cb10-274"><a href="#cb10-274" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"Model B: Control for L (collider)"</span>)</span>
<span id="cb10-275"><a href="#cb10-275" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb10-276"><a href="#cb10-276" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb10-277"><a href="#cb10-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-278"><a href="#cb10-278" aria-hidden="true" tabindex="-1"></a><span class="fu">## Which model looks better? </span></span>
<span id="cb10-279"><a href="#cb10-279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-282"><a href="#cb10-282" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb10-283"><a href="#cb10-283" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: sim2-metrics</span></span>
<span id="cb10-284"><a href="#cb10-284" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb10-285"><a href="#cb10-285" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb10-286"><a href="#cb10-286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-287"><a href="#cb10-287" aria-hidden="true" tabindex="-1"></a><span class="fu">compare_performance</span>(fit_biased, fit_correct, <span class="at">rank =</span> <span class="cn">TRUE</span>)</span>
<span id="cb10-288"><a href="#cb10-288" aria-hidden="true" tabindex="-1"></a><span class="fu">BIC</span>(fit_biased) <span class="sc">-</span> <span class="fu">BIC</span>(fit_correct)</span>
<span id="cb10-289"><a href="#cb10-289" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb10-290"><a href="#cb10-290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-291"><a href="#cb10-291" aria-hidden="true" tabindex="-1"></a><span class="fu">## Take-Home</span></span>
<span id="cb10-292"><a href="#cb10-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-293"><a href="#cb10-293" aria-hidden="true" tabindex="-1"></a>::: callout-important</span>
<span id="cb10-294"><a href="#cb10-294" aria-hidden="true" tabindex="-1"></a>Relying on model fit perpetuates the *causality crisis* in psychology <span class="co">[</span><span class="ot">@bulbulia2022</span><span class="co">]</span>.  </span>
<span id="cb10-295"><a href="#cb10-295" aria-hidden="true" tabindex="-1"></a>Draw the DAG first; decide what belongs in the model before looking at numbers.</span>
<span id="cb10-296"><a href="#cb10-296" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb10-297"><a href="#cb10-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-298"><a href="#cb10-298" aria-hidden="true" tabindex="-1"></a><span class="fu">## The What Error is widespread in **experimental** studies in the social sciences</span></span>
<span id="cb10-299"><a href="#cb10-299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-300"><a href="#cb10-300" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>"Overall, we find that **46.7% of the experimental studies** published in APSR, AJPS, and JOP from 2012 to 2014 engaged in posttreatment conditioning (35 of 75 studies) ..."</span>
<span id="cb10-301"><a href="#cb10-301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-302"><a href="#cb10-302" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>"About **1 in 4 drop cases or subset the data based on post-treatment criteria,** and **nearly a third include post-treatment variables as covariates**"</span>
<span id="cb10-303"><a href="#cb10-303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-304"><a href="#cb10-304" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>"Most tellingly, **nearly 1 in 8 articles directly conditions on variables that the authors themselves show as being an outcome of the experiment** -- an unambiguous indicator of **a fundamental lack of understanding ... that conditioning on posttreatment variables can invalidate results from randomized experiments.**"</span>
<span id="cb10-305"><a href="#cb10-305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-306"><a href="#cb10-306" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>"Empirically, then, the answer to the question of **whether the discipline already understands posttreatment bias is clear: It does not.**" <span class="co">[</span><span class="ot">@montgomery2018</span><span class="co">]</span></span>
<span id="cb10-307"><a href="#cb10-307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-308"><a href="#cb10-308" aria-hidden="true" tabindex="-1"></a><span class="fu">## Mediator Bias control strategy: **Longitudinal Hygiene**</span></span>
<span id="cb10-309"><a href="#cb10-309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-310"><a href="#cb10-310" aria-hidden="true" tabindex="-1"></a>::: columns</span>
<span id="cb10-311"><a href="#cb10-311" aria-hidden="true" tabindex="-1"></a>::: {.column width="50%"}</span>
<span id="cb10-312"><a href="#cb10-312" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb10-313"><a href="#cb10-313" aria-hidden="true" tabindex="-1"></a>\mediatorT</span>
<span id="cb10-314"><a href="#cb10-314" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb10-315"><a href="#cb10-315" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb10-316"><a href="#cb10-316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-317"><a href="#cb10-317" aria-hidden="true" tabindex="-1"></a>::: {.column width="50%"}</span>
<span id="cb10-318"><a href="#cb10-318" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb10-319"><a href="#cb10-319" aria-hidden="true" tabindex="-1"></a>\commoncausesolvedT</span>
<span id="cb10-320"><a href="#cb10-320" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb10-321"><a href="#cb10-321" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb10-322"><a href="#cb10-322" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb10-323"><a href="#cb10-323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-324"><a href="#cb10-324" aria-hidden="true" tabindex="-1"></a><span class="fu">## How to Tame The What Error? **Hide your future**</span></span>
<span id="cb10-325"><a href="#cb10-325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-326"><a href="#cb10-326" aria-hidden="true" tabindex="-1"></a>Use Repeated Measures on the Same Individuals</span>
<span id="cb10-327"><a href="#cb10-327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-328"><a href="#cb10-328" aria-hidden="true" tabindex="-1"></a><span class="fu">## Collider bias control strategy: **Hide your future**</span></span>
<span id="cb10-329"><a href="#cb10-329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-330"><a href="#cb10-330" aria-hidden="true" tabindex="-1"></a>::: columns</span>
<span id="cb10-331"><a href="#cb10-331" aria-hidden="true" tabindex="-1"></a>::: {.column width="50%"}</span>
<span id="cb10-332"><a href="#cb10-332" aria-hidden="true" tabindex="-1"></a>$$\colliderT$$</span>
<span id="cb10-333"><a href="#cb10-333" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb10-334"><a href="#cb10-334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-335"><a href="#cb10-335" aria-hidden="true" tabindex="-1"></a>::: {.column width="50%"}</span>
<span id="cb10-336"><a href="#cb10-336" aria-hidden="true" tabindex="-1"></a>$$\commoncausesolvedT$$</span>
<span id="cb10-337"><a href="#cb10-337" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb10-338"><a href="#cb10-338" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb10-339"><a href="#cb10-339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-340"><a href="#cb10-340" aria-hidden="true" tabindex="-1"></a><span class="fu">## Collider bias by proxy control strategy: **Hide your future**</span></span>
<span id="cb10-341"><a href="#cb10-341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-342"><a href="#cb10-342" aria-hidden="true" tabindex="-1"></a>::: columns</span>
<span id="cb10-343"><a href="#cb10-343" aria-hidden="true" tabindex="-1"></a>::: {.column width="50%"}</span>
<span id="cb10-344"><a href="#cb10-344" aria-hidden="true" tabindex="-1"></a>$$\commoncausechildT$$</span>
<span id="cb10-345"><a href="#cb10-345" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb10-346"><a href="#cb10-346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-347"><a href="#cb10-347" aria-hidden="true" tabindex="-1"></a>::: {.column width="50%"}</span>
<span id="cb10-348"><a href="#cb10-348" aria-hidden="true" tabindex="-1"></a>$$\commoncausesolvedchildT$$</span>
<span id="cb10-349"><a href="#cb10-349" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb10-350"><a href="#cb10-350" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb10-351"><a href="#cb10-351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-352"><a href="#cb10-352" aria-hidden="true" tabindex="-1"></a><span class="fu">## Post-exposure collider bias control strategy: **Hide your future**</span></span>
<span id="cb10-353"><a href="#cb10-353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-354"><a href="#cb10-354" aria-hidden="true" tabindex="-1"></a>::: columns</span>
<span id="cb10-355"><a href="#cb10-355" aria-hidden="true" tabindex="-1"></a>::: {.column width="50%"}</span>
<span id="cb10-356"><a href="#cb10-356" aria-hidden="true" tabindex="-1"></a>$$\mediatorcolliderT$$</span>
<span id="cb10-357"><a href="#cb10-357" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb10-358"><a href="#cb10-358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-359"><a href="#cb10-359" aria-hidden="true" tabindex="-1"></a>::: {.column width="50%"}</span>
<span id="cb10-360"><a href="#cb10-360" aria-hidden="true" tabindex="-1"></a>$$\commoncausesolvedT$$</span>
<span id="cb10-361"><a href="#cb10-361" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb10-362"><a href="#cb10-362" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb10-363"><a href="#cb10-363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-364"><a href="#cb10-364" aria-hidden="true" tabindex="-1"></a><span class="fu">## Finally, our biggest worry: **Unmeasured Common Causes**</span></span>
<span id="cb10-365"><a href="#cb10-365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-366"><a href="#cb10-366" aria-hidden="true" tabindex="-1"></a>$$\downstreamT$$</span>
<span id="cb10-367"><a href="#cb10-367" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-368"><a href="#cb10-368" aria-hidden="true" tabindex="-1"></a><span class="fu">## Unmeasured common cause strategy: **Hide your future**</span></span>
<span id="cb10-369"><a href="#cb10-369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-370"><a href="#cb10-370" aria-hidden="true" tabindex="-1"></a>::: columns</span>
<span id="cb10-371"><a href="#cb10-371" aria-hidden="true" tabindex="-1"></a>::: {.column width="50%"}</span>
<span id="cb10-372"><a href="#cb10-372" aria-hidden="true" tabindex="-1"></a>$$\downstreamT$$</span>
<span id="cb10-373"><a href="#cb10-373" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb10-374"><a href="#cb10-374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-375"><a href="#cb10-375" aria-hidden="true" tabindex="-1"></a>::: {.column width="50%"}</span>
<span id="cb10-376"><a href="#cb10-376" aria-hidden="true" tabindex="-1"></a>$$\commoncausesolvedT$$</span>
<span id="cb10-377"><a href="#cb10-377" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb10-378"><a href="#cb10-378" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb10-379"><a href="#cb10-379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-380"><a href="#cb10-380" aria-hidden="true" tabindex="-1"></a>And because \textcolor{cyan}{hope is not enough}, we should consistently report sensitivity analyses.</span>
<span id="cb10-381"><a href="#cb10-381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-382"><a href="#cb10-382" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- The E-value is the minimum strength of association, on the risk ratio scale, that an unmeasured confounder would need to have with both the treatment and the outcome, conditional on the measured covariates, to explain away treatment–outcome association. --&gt;</span></span>
<span id="cb10-383"><a href="#cb10-383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-384"><a href="#cb10-384" aria-hidden="true" tabindex="-1"></a><span class="fu">## Are longitudinal data + sensitivity analysis enough?</span></span>
<span id="cb10-385"><a href="#cb10-385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-386"><a href="#cb10-386" aria-hidden="true" tabindex="-1"></a>::: columns</span>
<span id="cb10-387"><a href="#cb10-387" aria-hidden="true" tabindex="-1"></a>::: {.column width="50%"}</span>
<span id="cb10-388"><a href="#cb10-388" aria-hidden="true" tabindex="-1"></a>If the data we collect were like this: $$Y_{\text{time 0}} ~~...~~ A_{\text{time 1}}$$</span>
<span id="cb10-389"><a href="#cb10-389" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb10-390"><a href="#cb10-390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-391"><a href="#cb10-391" aria-hidden="true" tabindex="-1"></a>::: {.column width="50%"}</span>
<span id="cb10-392"><a href="#cb10-392" aria-hidden="true" tabindex="-1"></a>We should not be tempted to model this.</span>
<span id="cb10-393"><a href="#cb10-393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-394"><a href="#cb10-394" aria-hidden="true" tabindex="-1"></a>$$\ytoacrazyT$$</span>
<span id="cb10-395"><a href="#cb10-395" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb10-396"><a href="#cb10-396" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb10-397"><a href="#cb10-397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-398"><a href="#cb10-398" aria-hidden="true" tabindex="-1"></a><span class="fu">## Are longitudinal data + sensitivity analysis enough?</span></span>
<span id="cb10-399"><a href="#cb10-399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-400"><a href="#cb10-400" aria-hidden="true" tabindex="-1"></a>\textcolor{cyan}{Too obvious} this is wrong?</span>
<span id="cb10-401"><a href="#cb10-401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-402"><a href="#cb10-402" aria-hidden="true" tabindex="-1"></a>$$\ytoacrazyT$$</span>
<span id="cb10-403"><a href="#cb10-403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-404"><a href="#cb10-404" aria-hidden="true" tabindex="-1"></a><span class="fu"># Error 2: When (time-zero)</span></span>
<span id="cb10-405"><a href="#cb10-405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-406"><a href="#cb10-406" aria-hidden="true" tabindex="-1"></a><span class="fu">## **Longitudinal data** are **not** enough</span></span>
<span id="cb10-407"><a href="#cb10-407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-408"><a href="#cb10-408" aria-hidden="true" tabindex="-1"></a>Temporal ordering was \textcolor{cyan}{precisely the problem} with the observational hormone studies in the 80s/90s that modelled \textcolor{cyan}{longitudinal data}.</span>
<span id="cb10-409"><a href="#cb10-409" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-410"><a href="#cb10-410" aria-hidden="true" tabindex="-1"></a>**How?**</span>
<span id="cb10-411"><a href="#cb10-411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-412"><a href="#cb10-412" aria-hidden="true" tabindex="-1"></a><span class="fu">## Researchers failed to emulate an experiment in their data (Target Trial)</span></span>
<span id="cb10-413"><a href="#cb10-413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-414"><a href="#cb10-414" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Women's Health Initiative: overall hazard ratio 1.23 (0.99, 1.53)</span>
<span id="cb10-415"><a href="#cb10-415" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-416"><a href="#cb10-416" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Women's Health Initiative: when broken down by years to follow-up:</span>
<span id="cb10-417"><a href="#cb10-417" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-418"><a href="#cb10-418" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>0-2 years 1.51 (1.06, 2.14)</span>
<span id="cb10-419"><a href="#cb10-419" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>2-5 years 1.31 (0.93, 1.83)</span>
<span id="cb10-420"><a href="#cb10-420" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>5 or more years **0.67 (0.41, 1.09)**</span>
<span id="cb10-421"><a href="#cb10-421" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-422"><a href="#cb10-422" aria-hidden="true" tabindex="-1"></a>::: {.callout-note title="Survivor Bias." icon="false"}</span>
<span id="cb10-423"><a href="#cb10-423" aria-hidden="true" tabindex="-1"></a>The observational results can be \textcolor{cyan}{entirely explained by selection bias}</span>
<span id="cb10-424"><a href="#cb10-424" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb10-425"><a href="#cb10-425" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-426"><a href="#cb10-426" aria-hidden="true" tabindex="-1"></a>::: {.callout-note title="Emulating a target trial with observational data recovers experimental effects." icon="false"}</span>
<span id="cb10-427"><a href="#cb10-427" aria-hidden="true" tabindex="-1"></a>Re-modelling \textcolor{cyan}{initiation into hormone therapy} recovers experimental findings <span class="co">[</span><span class="ot">@hernan2016</span><span class="co">]</span>.</span>
<span id="cb10-428"><a href="#cb10-428" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb10-429"><a href="#cb10-429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-430"><a href="#cb10-430" aria-hidden="true" tabindex="-1"></a><span class="fu">## Visualising the When Error</span></span>
<span id="cb10-431"><a href="#cb10-431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-434"><a href="#cb10-434" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb10-435"><a href="#cb10-435" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-time-zero-3lines</span></span>
<span id="cb10-436"><a href="#cb10-436" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Three ways to start the clock. Only one is right."</span></span>
<span id="cb10-437"><a href="#cb10-437" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8</span></span>
<span id="cb10-438"><a href="#cb10-438" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4</span></span>
<span id="cb10-439"><a href="#cb10-439" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb10-440"><a href="#cb10-440" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb10-441"><a href="#cb10-441" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb10-442"><a href="#cb10-442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-443"><a href="#cb10-443" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb10-444"><a href="#cb10-444" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-445"><a href="#cb10-445" aria-hidden="true" tabindex="-1"></a><span class="co"># lifeline coordinates ----------------------------------------------------</span></span>
<span id="cb10-446"><a href="#cb10-446" aria-hidden="true" tabindex="-1"></a>lifelines <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb10-447"><a href="#cb10-447" aria-hidden="true" tabindex="-1"></a>  <span class="at">scenario =</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">"early time-zero"</span>, <span class="st">"correct time-zero"</span>, <span class="st">"late time-zero"</span>),</span>
<span id="cb10-448"><a href="#cb10-448" aria-hidden="true" tabindex="-1"></a>                    <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"early time-zero"</span>, <span class="st">"correct time-zero"</span>, <span class="st">"late time-zero"</span>)),</span>
<span id="cb10-449"><a href="#cb10-449" aria-hidden="true" tabindex="-1"></a>  <span class="at">clinic =</span> <span class="dv">0</span>,      <span class="co"># day of clinic visit</span></span>
<span id="cb10-450"><a href="#cb10-450" aria-hidden="true" tabindex="-1"></a>  <span class="at">rx     =</span> <span class="dv">30</span>,     <span class="co"># day prescription filled</span></span>
<span id="cb10-451"><a href="#cb10-451" aria-hidden="true" tabindex="-1"></a>  <span class="at">event  =</span> <span class="dv">200</span>     <span class="co"># day outcome occurs</span></span>
<span id="cb10-452"><a href="#cb10-452" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb10-453"><a href="#cb10-453" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-454"><a href="#cb10-454" aria-hidden="true" tabindex="-1"></a><span class="co"># plot --------------------------------------------------------------------</span></span>
<span id="cb10-455"><a href="#cb10-455" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(lifelines) <span class="sc">+</span></span>
<span id="cb10-456"><a href="#cb10-456" aria-hidden="true" tabindex="-1"></a>  <span class="do">## horizontal lifelines</span></span>
<span id="cb10-457"><a href="#cb10-457" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> clinic, <span class="at">xend =</span> event,</span>
<span id="cb10-458"><a href="#cb10-458" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y =</span> scenario, <span class="at">yend =</span> scenario),</span>
<span id="cb10-459"><a href="#cb10-459" aria-hidden="true" tabindex="-1"></a>               <span class="at">linewidth =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb10-460"><a href="#cb10-460" aria-hidden="true" tabindex="-1"></a>  <span class="do">## milestone dots</span></span>
<span id="cb10-461"><a href="#cb10-461" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> clinic, <span class="at">y =</span> scenario), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb10-462"><a href="#cb10-462" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> rx,     <span class="at">y =</span> scenario), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb10-463"><a href="#cb10-463" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> event,  <span class="at">y =</span> scenario), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb10-464"><a href="#cb10-464" aria-hidden="true" tabindex="-1"></a>  <span class="do">## dashed t = 0 lines</span></span>
<span id="cb10-465"><a href="#cb10-465" aria-hidden="true" tabindex="-1"></a>  <span class="co"># early (wrong)</span></span>
<span id="cb10-466"><a href="#cb10-466" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">x =</span> <span class="dv">0</span>,  <span class="at">xend =</span> <span class="dv">0</span>,  <span class="at">y =</span> <span class="fl">0.7</span>, <span class="at">yend =</span> <span class="fl">1.3</span>,</span>
<span id="cb10-467"><a href="#cb10-467" aria-hidden="true" tabindex="-1"></a>               <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">colour =</span> <span class="st">"red"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb10-468"><a href="#cb10-468" aria-hidden="true" tabindex="-1"></a>  <span class="co"># correct</span></span>
<span id="cb10-469"><a href="#cb10-469" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">x =</span> <span class="dv">30</span>, <span class="at">xend =</span> <span class="dv">30</span>, <span class="at">y =</span> <span class="fl">1.7</span>, <span class="at">yend =</span> <span class="fl">2.3</span>,</span>
<span id="cb10-470"><a href="#cb10-470" aria-hidden="true" tabindex="-1"></a>               <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">colour =</span> <span class="st">"forestgreen"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb10-471"><a href="#cb10-471" aria-hidden="true" tabindex="-1"></a>  <span class="co"># late (wrong)</span></span>
<span id="cb10-472"><a href="#cb10-472" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">x =</span> <span class="dv">60</span>, <span class="at">xend =</span> <span class="dv">60</span>, <span class="at">y =</span> <span class="fl">2.7</span>, <span class="at">yend =</span> <span class="fl">3.3</span>,</span>
<span id="cb10-473"><a href="#cb10-473" aria-hidden="true" tabindex="-1"></a>               <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">colour =</span> <span class="st">"red"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb10-474"><a href="#cb10-474" aria-hidden="true" tabindex="-1"></a>  <span class="do">## labels</span></span>
<span id="cb10-475"><a href="#cb10-475" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">0</span>,   <span class="at">y =</span> <span class="fl">1.35</span>, <span class="at">label =</span> <span class="st">"t = 0 (early, wrong)"</span>,</span>
<span id="cb10-476"><a href="#cb10-476" aria-hidden="true" tabindex="-1"></a>           <span class="at">colour =</span> <span class="st">"red"</span>, <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="fl">3.8</span>) <span class="sc">+</span></span>
<span id="cb10-477"><a href="#cb10-477" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">30</span>,  <span class="at">y =</span> <span class="fl">2.35</span>, <span class="at">label =</span> <span class="st">"t = 0 (correct)"</span>,</span>
<span id="cb10-478"><a href="#cb10-478" aria-hidden="true" tabindex="-1"></a>           <span class="at">colour =</span> <span class="st">"forestgreen"</span>, <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="fl">3.8</span>) <span class="sc">+</span></span>
<span id="cb10-479"><a href="#cb10-479" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">60</span>,  <span class="at">y =</span> <span class="fl">3.35</span>, <span class="at">label =</span> <span class="st">"t = 0 (late, wrong)"</span>,</span>
<span id="cb10-480"><a href="#cb10-480" aria-hidden="true" tabindex="-1"></a>           <span class="at">colour =</span> <span class="st">"red"</span>, <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="fl">3.8</span>) <span class="sc">+</span></span>
<span id="cb10-481"><a href="#cb10-481" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">0</span>,   <span class="at">y =</span> <span class="fl">1.05</span>, <span class="at">label =</span> <span class="st">"clinic visit"</span>, <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb10-482"><a href="#cb10-482" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">30</span>,  <span class="at">y =</span> <span class="fl">2.05</span>, <span class="at">label =</span> <span class="st">"rx pickup"</span>,    <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb10-483"><a href="#cb10-483" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">200</span>, <span class="at">y =</span> <span class="fl">3.05</span>, <span class="at">label =</span> <span class="st">"event"</span>,        <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb10-484"><a href="#cb10-484" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb10-485"><a href="#cb10-485" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb10-486"><a href="#cb10-486" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb10-487"><a href="#cb10-487" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks  =</span> <span class="fu">element_blank</span>())</span>
<span id="cb10-488"><a href="#cb10-488" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb10-489"><a href="#cb10-489" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb10-490"><a href="#cb10-490" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-491"><a href="#cb10-491" aria-hidden="true" tabindex="-1"></a><span class="fu">## Target Trial Check List</span></span>
<span id="cb10-492"><a href="#cb10-492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-495"><a href="#cb10-495" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb10-496"><a href="#cb10-496" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-target-trial</span></span>
<span id="cb10-497"><a href="#cb10-497" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Target-trial specification for the hormone-therapy example."</span></span>
<span id="cb10-498"><a href="#cb10-498" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb10-499"><a href="#cb10-499" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-500"><a href="#cb10-500" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb10-501"><a href="#cb10-501" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb10-502"><a href="#cb10-502" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-503"><a href="#cb10-503" aria-hidden="true" tabindex="-1"></a><span class="fu">tribble</span>(</span>
<span id="cb10-504"><a href="#cb10-504" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span>element,      <span class="sc">~</span>definition,</span>
<span id="cb10-505"><a href="#cb10-505" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Eligibility"</span>, <span class="st">"Post-menopausal women aged 50–79, no prior CHD"</span>,</span>
<span id="cb10-506"><a href="#cb10-506" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Treatment"</span>,   <span class="st">"Initiate oestrogen + progestin on day of Rx pickup"</span>,</span>
<span id="cb10-507"><a href="#cb10-507" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Comparison"</span>,  <span class="st">"No hormone-therapy initiation on that day"</span>,</span>
<span id="cb10-508"><a href="#cb10-508" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Outcome"</span>,     <span class="st">"All-cause mortality"</span>,</span>
<span id="cb10-509"><a href="#cb10-509" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Follow-up"</span>,   <span class="st">"8 years or until death / loss to follow-up"</span></span>
<span id="cb10-510"><a href="#cb10-510" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span></span>
<span id="cb10-511"><a href="#cb10-511" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">booktabs =</span> <span class="cn">TRUE</span>, <span class="at">align =</span> <span class="st">"l"</span>) <span class="sc">|&gt;</span></span>
<span id="cb10-512"><a href="#cb10-512" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">latex_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hold_position"</span>))</span>
<span id="cb10-513"><a href="#cb10-513" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb10-514"><a href="#cb10-514" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-515"><a href="#cb10-515" aria-hidden="true" tabindex="-1"></a><span class="fu"># Error 3 – Who (population and heterogeneity)</span></span>
<span id="cb10-516"><a href="#cb10-516" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-517"><a href="#cb10-517" aria-hidden="true" tabindex="-1"></a><span class="fu">## Illustration </span></span>
<span id="cb10-518"><a href="#cb10-518" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-519"><a href="#cb10-519" aria-hidden="true" tabindex="-1"></a><span class="fu"># New Zealand Attitudes and Values Study (NZAVS): A step-by-step workflow for causal inference</span></span>
<span id="cb10-520"><a href="#cb10-520" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-521"><a href="#cb10-521" aria-hidden="true" tabindex="-1"></a><span class="fu">## The New Zealand Attitudes and Values Study:</span></span>
<span id="cb10-522"><a href="#cb10-522" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-523"><a href="#cb10-523" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Planned 20-year longitudinal study, currently in its 14th year, &gt; 77k measured</span>
<span id="cb10-524"><a href="#cb10-524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-525"><a href="#cb10-525" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Sample frame is drawn randomly from the NZ Electoral Roll.</span>
<span id="cb10-526"><a href="#cb10-526" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-527"><a href="#cb10-527" aria-hidden="true" tabindex="-1"></a><span class="fu">## Causal Questions</span></span>
<span id="cb10-528"><a href="#cb10-528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-529"><a href="#cb10-529" aria-hidden="true" tabindex="-1"></a>1) Average Treatment Effect: Difference in averages of social outcomes (a) if everyone in New Zealand were to attend religious service at least 1x per month (b) if everyone were not to attend religious service at all. </span>
<span id="cb10-530"><a href="#cb10-530" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-531"><a href="#cb10-531" aria-hidden="true" tabindex="-1"></a>2) Heterogeneous Treatment Effects: Machine learning of groups who differ in such effects. Focus here on Qini Curve at 20% and 30% of full "budget". </span>
<span id="cb10-532"><a href="#cb10-532" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-533"><a href="#cb10-533" aria-hidden="true" tabindex="-1"></a>3) Use Qini results to select for Policy Trees: Clarify *who* responds strongly/weakly. </span>
<span id="cb10-534"><a href="#cb10-534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-535"><a href="#cb10-535" aria-hidden="true" tabindex="-1"></a>**Note: all results use "honest" learning -- sample is split into training/test sets (here 70/30).**</span>
<span id="cb10-536"><a href="#cb10-536" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-537"><a href="#cb10-537" aria-hidden="true" tabindex="-1"></a><span class="fu">## Outcomes </span></span>
<span id="cb10-538"><a href="#cb10-538" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-539"><a href="#cb10-539" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Sense of Belonging</span>
<span id="cb10-540"><a href="#cb10-540" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Social Support</span>
<span id="cb10-541"><a href="#cb10-541" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Charitable Donations (annual)</span>
<span id="cb10-542"><a href="#cb10-542" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>Volunteering (weekly)</span>
<span id="cb10-543"><a href="#cb10-543" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-544"><a href="#cb10-544" aria-hidden="true" tabindex="-1"></a>**All outcomes measured one year after the intervention**</span>
<span id="cb10-545"><a href="#cb10-545" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-546"><a href="#cb10-546" aria-hidden="true" tabindex="-1"></a><span class="fu">## Three-wave Panel Design: control for baseline exposure and outcome among confounder set. </span></span>
<span id="cb10-547"><a href="#cb10-547" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-548"><a href="#cb10-548" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb10-549"><a href="#cb10-549" aria-hidden="true" tabindex="-1"></a>\threeLONG</span>
<span id="cb10-550"><a href="#cb10-550" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb10-551"><a href="#cb10-551" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-552"><a href="#cb10-552" aria-hidden="true" tabindex="-1"></a><span class="fu">## Target Population: Residents of New Zealand in 2018 had they not been censored through 2021.</span></span>
<span id="cb10-553"><a href="#cb10-553" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-554"><a href="#cb10-554" aria-hidden="true" tabindex="-1"></a><span class="fu">### Census Weights (Age X Gender X Ethnicity)</span></span>
<span id="cb10-555"><a href="#cb10-555" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-556"><a href="#cb10-556" aria-hidden="true" tabindex="-1"></a><span class="al">![](hist_sample_weights.png)</span></span>
<span id="cb10-557"><a href="#cb10-557" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-558"><a href="#cb10-558" aria-hidden="true" tabindex="-1"></a><span class="fu">### (IPCW Stabilised &amp; Trimmed)</span></span>
<span id="cb10-559"><a href="#cb10-559" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-560"><a href="#cb10-560" aria-hidden="true" tabindex="-1"></a><span class="al">![](hist_combo_weights.png)</span></span>
<span id="cb10-561"><a href="#cb10-561" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-562"><a href="#cb10-562" aria-hidden="true" tabindex="-1"></a><span class="fu">## Religious Service Intervention</span></span>
<span id="cb10-563"><a href="#cb10-563" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-564"><a href="#cb10-564" aria-hidden="true" tabindex="-1"></a>$$f(A) = \begin{cases} 1 &amp; \text{if } a \ge 0 \text{ At least 1 x per month Religious Attendance} <span class="sc">\\</span> 0 &amp; \text{if } a = 0 \text{ Monthly Religious Service} \end{cases}$$</span>
<span id="cb10-565"><a href="#cb10-565" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-566"><a href="#cb10-566" aria-hidden="true" tabindex="-1"></a><span class="fu">## Histogram Showing Split</span></span>
<span id="cb10-567"><a href="#cb10-567" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-568"><a href="#cb10-568" aria-hidden="true" tabindex="-1"></a><span class="al">![](2025_church_graph_cut.png)</span></span>
<span id="cb10-569"><a href="#cb10-569" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-570"><a href="#cb10-570" aria-hidden="true" tabindex="-1"></a><span class="fu">## Love Plot of Propensity Scores</span></span>
<span id="cb10-571"><a href="#cb10-571" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-572"><a href="#cb10-572" aria-hidden="true" tabindex="-1"></a><span class="al">![](2025_church_propensity.png)</span></span>
<span id="cb10-573"><a href="#cb10-573" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-574"><a href="#cb10-574" aria-hidden="true" tabindex="-1"></a><span class="fu">## Average Treatment Effect Results: </span></span>
<span id="cb10-575"><a href="#cb10-575" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-576"><a href="#cb10-576" aria-hidden="true" tabindex="-1"></a><span class="fu">## Workflow</span></span>
<span id="cb10-577"><a href="#cb10-577" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-578"><a href="#cb10-578" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Target population: New Zealand Population by 2018 census weights</span>
<span id="cb10-579"><a href="#cb10-579" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Outcomes: all NZAVS outcomes relating to pro-sociality (outcome-wide study)</span>
<span id="cb10-580"><a href="#cb10-580" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Missing data: inverse-probability of censoring weights non-parametrically estimated/ causal forests permit missing data at baseline</span>
<span id="cb10-581"><a href="#cb10-581" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Eligibility: participated in NZAVS 2018 (wave-10) and 2019 (wave 11, exposure wave) may have been lost to follow-up in wave 12, **46,377**.</span>
<span id="cb10-582"><a href="#cb10-582" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Bonferroni correct for multiple comparisons / E-value threshold = 1.2</span>
<span id="cb10-583"><a href="#cb10-583" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-584"><a href="#cb10-584" aria-hidden="true" tabindex="-1"></a><span class="fu">## Transition table: Religious Attendance</span></span>
<span id="cb10-585"><a href="#cb10-585" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-586"><a href="#cb10-586" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span>From / To <span class="pp">|</span> State 0<span class="pp">|</span> State 1<span class="pp">|</span> Total<span class="pp">|</span></span>
<span id="cb10-587"><a href="#cb10-587" aria-hidden="true" tabindex="-1"></a><span class="pp">|:---------|-------:|-------:|-----:|</span></span>
<span id="cb10-588"><a href="#cb10-588" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span>State 0   <span class="pp">|</span>   28545<span class="pp">|</span>     681<span class="pp">|</span> 29226<span class="pp">|</span></span>
<span id="cb10-589"><a href="#cb10-589" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span>State 1   <span class="pp">|</span>     887<span class="pp">|</span>    3593<span class="pp">|</span>  4480<span class="pp">|</span></span>
<span id="cb10-590"><a href="#cb10-590" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-591"><a href="#cb10-591" aria-hidden="true" tabindex="-1"></a><span class="fu">## Average Treatment Effect</span></span>
<span id="cb10-592"><a href="#cb10-592" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-593"><a href="#cb10-593" aria-hidden="true" tabindex="-1"></a>The following outcomes showed reliable causal evidence (E‑value lower bound &gt; 1.2):</span>
<span id="cb10-594"><a href="#cb10-594" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Volunteering (weekly, log): 0.154(0.056,0.252); on the original scale, 11.264 minutes(3.943,19.158). E‑value bound = 1.287</span>
<span id="cb10-595"><a href="#cb10-595" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>log Charity Donate: 0.13(0.045,0.215); on the original scale, 39.935 (12.247,74.883). E‑value bound = 1.25</span>
<span id="cb10-596"><a href="#cb10-596" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-597"><a href="#cb10-597" aria-hidden="true" tabindex="-1"></a><span class="fu"># Graph ATE</span></span>
<span id="cb10-598"><a href="#cb10-598" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-599"><a href="#cb10-599" aria-hidden="true" tabindex="-1"></a><span class="al">![](2025_church_ate.png)</span></span>
<span id="cb10-600"><a href="#cb10-600" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-601"><a href="#cb10-601" aria-hidden="true" tabindex="-1"></a><span class="fu">## How Much Better if We Treated by CATE? </span></span>
<span id="cb10-602"><a href="#cb10-602" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-603"><a href="#cb10-603" aria-hidden="true" tabindex="-1"></a><span class="al">![](2025_church_combined_qini.png)</span></span>
<span id="cb10-604"><a href="#cb10-604" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-605"><a href="#cb10-605" aria-hidden="true" tabindex="-1"></a><span class="fu">## Who Should We Treat First? Belonging</span></span>
<span id="cb10-606"><a href="#cb10-606" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-607"><a href="#cb10-607" aria-hidden="true" tabindex="-1"></a><span class="al">![](2025_2L_church_on_belonging.png)</span></span>
<span id="cb10-608"><a href="#cb10-608" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-609"><a href="#cb10-609" aria-hidden="true" tabindex="-1"></a><span class="fu">## Who Should We Treat First? Charitable Donations</span></span>
<span id="cb10-610"><a href="#cb10-610" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-611"><a href="#cb10-611" aria-hidden="true" tabindex="-1"></a><span class="al">![](2025_2L_church_on_charity_donations.png)</span></span>
<span id="cb10-612"><a href="#cb10-612" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-613"><a href="#cb10-613" aria-hidden="true" tabindex="-1"></a><span class="fu">## Closing</span></span>
<span id="cb10-614"><a href="#cb10-614" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-615"><a href="#cb10-615" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **Error** | **Need**                         | **Remedy**                                         <span class="pp">|</span></span>
<span id="cb10-616"><a href="#cb10-616" aria-hidden="true" tabindex="-1"></a><span class="pp">|-----------|----------------------------------|----------------------------------------------------|</span></span>
<span id="cb10-617"><a href="#cb10-617" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> What      <span class="pp">|</span> Control the right variables      <span class="pp">|</span> Draw a DAG first                                   <span class="pp">|</span></span>
<span id="cb10-618"><a href="#cb10-618" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> When      <span class="pp">|</span> Start the clock on time          <span class="pp">|</span> Emulate a target trial                             <span class="pp">|</span></span>
<span id="cb10-619"><a href="#cb10-619" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Who       <span class="pp">|</span> Treat the right people           <span class="pp">|</span> Weight to target + investigate heterogeneity       <span class="pp">|</span></span>
<span id="cb10-620"><a href="#cb10-620" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-621"><a href="#cb10-621" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- 3. Emulating experiments tend to \color{cyan}{attenuate results}. --&gt;</span></span>
<span id="cb10-622"><a href="#cb10-622" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-623"><a href="#cb10-623" aria-hidden="true" tabindex="-1"></a><span class="fu">## Thanks {.nonincremental}</span></span>
<span id="cb10-624"><a href="#cb10-624" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-625"><a href="#cb10-625" aria-hidden="true" tabindex="-1"></a>::: nonincremental</span>
<span id="cb10-626"><a href="#cb10-626" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>TRT Grant 0418 &amp; Max Planck Institute for Evolutionary Anthropology for support.</span>
<span id="cb10-627"><a href="#cb10-627" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Chris G. Sibley (NZAVS lead Investigator) for the heavy data lifting</span>
<span id="cb10-628"><a href="#cb10-628" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>77,490 NZAVS participants for their time</span>
<span id="cb10-629"><a href="#cb10-629" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>\textcolor{cyan}{Reach out} with questions or if you would like to become involved: \href{emailto:joseph.bulbulia@vuw.ac.nz}{joseph.bulbulia@vuw.ac.nz}</span>
<span id="cb10-630"><a href="#cb10-630" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb10-631"><a href="#cb10-631" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-632"><a href="#cb10-632" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb10-633"><a href="#cb10-633" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-634"><a href="#cb10-634" aria-hidden="true" tabindex="-1"></a><span class="al">![NZAVS](NZAVS-QR.png)</span></span>
<span id="cb10-635"><a href="#cb10-635" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-636"><a href="#cb10-636" aria-hidden="true" tabindex="-1"></a><span class="fu">## </span></span>
<span id="cb10-637"><a href="#cb10-637" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-638"><a href="#cb10-638" aria-hidden="true" tabindex="-1"></a>::: refs</span>
<span id="cb10-639"><a href="#cb10-639" aria-hidden="true" tabindex="-1"></a>:::</span>
</code></pre></div><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></div>
</div></div></div></div></div>
</div> <!-- /content -->




<script src="site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>